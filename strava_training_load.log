2025-09-12 18:57:16,315 - utils.feature_flags - INFO - \U0001f389 Enhanced TRIMP calculation access granted to user 1 (beta rollout)
2025-09-12 18:57:16,316 - utils.feature_flags - INFO - \U0001f389 Enhanced TRIMP calculation access granted to user 2 (beta rollout)
2025-09-12 18:57:16,316 - utils.feature_flags - INFO - \u23f3 Enhanced TRIMP calculation access denied to user 4 (not in beta rollout)
2025-09-12 18:57:16,317 - db_utils - INFO - db_utils: Attempting PostgreSQL connection within context manager.
2025-09-12 18:57:16,317 - db_utils - INFO - db_utils: DATABASE_URL: postgresql://appuser:trainmonk25@35.223.144.85:5432/train-d...
2025-09-12 18:57:16,317 - db_utils - INFO - db_utils: Using standard PostgreSQL connection.
2025-09-12 18:57:16,819 - db_utils - INFO - db_utils: PostgreSQL connection successful!
2025-09-12 18:57:17,106 - strava_training_load - INFO - TRIMP_CALC: Using average heart rate calculation (avg_hr=119.9, duration=68.13min)
2025-09-12 18:57:17,106 - strava_training_load - INFO - TRIMP_CALC: Average calculation successful: 65.83 (duration=68.13, avg_hr=119.9, HRR=0.54)
2025-09-12 18:57:17,106 - strava_training_load - INFO - TRIMP_CALC: Average calculation completed, result=65.83
2025-09-12 18:57:17,106 - strava_training_load - INFO - TRIMP_CALC: Using heart rate stream data (stream_length=4089, duration=68.13min)
2025-09-12 18:57:17,106 - strava_training_load - INFO - TRIMP_CALC: Stream validation passed (valid_samples=4089, total_samples=4089)
2025-09-12 18:57:17,106 - strava_training_load - INFO - TRIMP_CALC: Duration distribution: 68.13 minutes across 4089 samples = 0.0167 minutes per sample
2025-09-12 18:57:17,106 - strava_training_load - INFO - TRIMP_CALC: Sample 0: HR=60, HRR=0.077, TRIMP=0.0010
2025-09-12 18:57:17,106 - strava_training_load - INFO - TRIMP_CALC: Sample 1: HR=60, HRR=0.077, TRIMP=0.0010
2025-09-12 18:57:17,106 - strava_training_load - INFO - TRIMP_CALC: Sample 2: HR=60, HRR=0.077, TRIMP=0.0010
2025-09-12 18:57:17,121 - strava_training_load - INFO - TRIMP_CALC: Duration distribution: 4089 valid samples, no skipped samples
2025-09-12 18:57:17,121 - strava_training_load - INFO - TRIMP_CALC: Stream calculation successful: 72.92 (samples=4089, duration=68.13, duration_per_sample=0.0167)
2025-09-12 18:57:17,121 - strava_training_load - INFO - TRIMP_CALC: Stream calculation completed, result=72.92
2025-09-12 18:57:17,122 - strava_training_load - INFO - TRIMP_CALC: Using average heart rate calculation (avg_hr=119.9, duration=68.13min)
2025-09-12 18:57:17,122 - strava_training_load - INFO - TRIMP_CALC: Average calculation successful: 65.83 (duration=68.13, avg_hr=119.9, HRR=0.54)
2025-09-12 18:57:17,122 - strava_training_load - INFO - TRIMP_CALC: Average calculation completed, result=65.83
2025-09-12 18:57:17,122 - strava_training_load - INFO - TRIMP_CALC: Using heart rate stream data (stream_length=4089, duration=68.13min)
2025-09-12 18:57:17,122 - strava_training_load - INFO - TRIMP_CALC: Stream validation passed (valid_samples=4089, total_samples=4089)
2025-09-12 18:57:17,123 - strava_training_load - INFO - TRIMP_CALC: Duration distribution: 68.13 minutes across 4089 samples = 0.0167 minutes per sample
2025-09-12 18:57:17,123 - strava_training_load - INFO - TRIMP_CALC: Sample 0: HR=60, HRR=0.077, TRIMP=0.0010
2025-09-12 18:57:17,123 - strava_training_load - INFO - TRIMP_CALC: Sample 1: HR=60, HRR=0.077, TRIMP=0.0010
2025-09-12 18:57:17,123 - strava_training_load - INFO - TRIMP_CALC: Sample 2: HR=60, HRR=0.077, TRIMP=0.0010
2025-09-12 18:57:17,125 - strava_training_load - INFO - TRIMP_CALC: Duration distribution: 4089 valid samples, no skipped samples
2025-09-12 18:57:17,125 - strava_training_load - INFO - TRIMP_CALC: Stream calculation successful: 72.92 (samples=4089, duration=68.13, duration_per_sample=0.0167)
2025-09-12 18:57:17,125 - strava_training_load - INFO - TRIMP_CALC: Stream calculation completed, result=72.92
2025-09-12 18:57:17,126 - strava_training_load - INFO - TRIMP_CALC: Using average heart rate calculation (avg_hr=119.9, duration=68.13min)
2025-09-12 18:57:17,126 - strava_training_load - INFO - TRIMP_CALC: Average calculation successful: 65.83 (duration=68.13, avg_hr=119.9, HRR=0.54)
2025-09-12 18:57:17,126 - strava_training_load - INFO - TRIMP_CALC: Average calculation completed, result=65.83
2025-09-12 18:57:17,126 - strava_training_load - INFO - TRIMP_CALC: Using heart rate stream data (stream_length=4089, duration=68.13min)
2025-09-12 18:57:17,126 - strava_training_load - INFO - TRIMP_CALC: Stream validation passed (valid_samples=4089, total_samples=4089)
2025-09-12 18:57:17,127 - strava_training_load - INFO - TRIMP_CALC: Duration distribution: 68.13 minutes across 4089 samples = 0.0167 minutes per sample
2025-09-12 18:57:17,127 - strava_training_load - INFO - TRIMP_CALC: Sample 0: HR=60, HRR=0.077, TRIMP=0.0010
2025-09-12 18:57:17,127 - strava_training_load - INFO - TRIMP_CALC: Sample 1: HR=60, HRR=0.077, TRIMP=0.0010
2025-09-12 18:57:17,127 - strava_training_load - INFO - TRIMP_CALC: Sample 2: HR=60, HRR=0.077, TRIMP=0.0010
2025-09-12 18:57:17,129 - strava_training_load - INFO - TRIMP_CALC: Duration distribution: 4089 valid samples, no skipped samples
2025-09-12 18:57:17,129 - strava_training_load - INFO - TRIMP_CALC: Stream calculation successful: 72.92 (samples=4089, duration=68.13, duration_per_sample=0.0167)
2025-09-12 18:57:17,129 - strava_training_load - INFO - TRIMP_CALC: Stream calculation completed, result=72.92
2025-09-12 18:57:17,129 - db_utils - INFO - db_utils: Database connection closed.
2025-09-12 18:57:17,129 - db_utils - INFO - db_utils: Attempting PostgreSQL connection within context manager.
2025-09-12 18:57:17,129 - db_utils - INFO - db_utils: DATABASE_URL: postgresql://appuser:trainmonk25@35.223.144.85:5432/train-d...
2025-09-12 18:57:17,129 - db_utils - INFO - db_utils: Using standard PostgreSQL connection.
2025-09-12 18:57:17,640 - db_utils - INFO - db_utils: PostgreSQL connection successful!
2025-09-12 18:57:17,790 - db_utils - INFO - db_utils: Database connection closed.
2025-09-12 18:58:39,431 - db_utils - INFO - db_utils: Attempting PostgreSQL connection within context manager.
2025-09-12 18:58:39,431 - db_utils - INFO - db_utils: DATABASE_URL: postgresql://appuser:trainmonk25@35.223.144.85:5432/train-d...
2025-09-12 18:58:39,431 - db_utils - INFO - db_utils: Using standard PostgreSQL connection.
2025-09-12 18:58:40,167 - db_utils - INFO - db_utils: PostgreSQL connection successful!
2025-09-12 18:58:40,561 - utils.feature_flags - INFO - \U0001f389 Enhanced TRIMP calculation access granted to user 1 (beta rollout)
2025-09-12 18:58:40,562 - strava_training_load - INFO - TRIMP_CALC: Using heart rate stream data (stream_length=4089, duration=68.13min)
2025-09-12 18:58:40,563 - strava_training_load - INFO - TRIMP_CALC: Stream validation passed (valid_samples=4089, total_samples=4089)
2025-09-12 18:58:40,563 - strava_training_load - INFO - TRIMP_CALC: Duration distribution: 68.13 minutes across 4089 samples = 0.0167 minutes per sample
2025-09-12 18:58:40,563 - strava_training_load - INFO - TRIMP_CALC: Sample 0: HR=60, HRR=0.119, TRIMP=0.0016
2025-09-12 18:58:40,563 - strava_training_load - INFO - TRIMP_CALC: Sample 1: HR=60, HRR=0.119, TRIMP=0.0016
2025-09-12 18:58:40,563 - strava_training_load - INFO - TRIMP_CALC: Sample 2: HR=60, HRR=0.119, TRIMP=0.0016
2025-09-12 18:58:40,565 - strava_training_load - INFO - TRIMP_CALC: Duration distribution: 4089 valid samples, no skipped samples
2025-09-12 18:58:40,565 - strava_training_load - INFO - TRIMP_CALC: Stream calculation successful: 80.47 (samples=4089, duration=68.13, duration_per_sample=0.0167)
2025-09-12 18:58:40,566 - strava_training_load - INFO - TRIMP_CALC: Stream calculation completed, result=80.47
2025-09-12 18:58:40,566 - strava_training_load - INFO - TRIMP_CALC: Using average heart rate calculation (avg_hr=119.9, duration=68.13min)
2025-09-12 18:58:40,566 - strava_training_load - INFO - TRIMP_CALC: Average calculation successful: 73.28 (duration=68.13, avg_hr=119.9, HRR=0.57)
2025-09-12 18:58:40,566 - strava_training_load - INFO - TRIMP_CALC: Average calculation completed, result=73.28
2025-09-12 18:58:40,566 - strava_training_load - INFO - TRIMP_CALC: Stream validation passed (valid_samples=4089, total_samples=4089)
2025-09-12 18:58:40,566 - strava_training_load - INFO - TRIMP_CALC: Duration distribution: 68.13 minutes across 4089 samples = 0.0167 minutes per sample
2025-09-12 18:58:40,566 - strava_training_load - INFO - TRIMP_CALC: Sample 0: HR=60, HRR=0.119, TRIMP=0.0016
2025-09-12 18:58:40,566 - strava_training_load - INFO - TRIMP_CALC: Sample 1: HR=60, HRR=0.119, TRIMP=0.0016
2025-09-12 18:58:40,566 - strava_training_load - INFO - TRIMP_CALC: Sample 2: HR=60, HRR=0.119, TRIMP=0.0016
2025-09-12 18:58:40,569 - strava_training_load - INFO - TRIMP_CALC: Duration distribution: 4089 valid samples, no skipped samples
2025-09-12 18:58:40,569 - strava_training_load - INFO - TRIMP_CALC: Stream calculation successful: 80.47 (samples=4089, duration=68.13, duration_per_sample=0.0167)
2025-09-12 18:58:40,569 - strava_training_load - INFO - TRIMP_CALC: Average calculation successful: 73.28 (duration=68.13, avg_hr=119.9, HRR=0.57)
2025-09-12 18:58:40,569 - strava_training_load - INFO - TRIMP_CALC: Using average heart rate calculation (avg_hr=119.87062851552948, duration=68.13min)
2025-09-12 18:58:40,569 - strava_training_load - INFO - TRIMP_CALC: Average calculation successful: 73.22 (duration=68.13, avg_hr=119.87062851552948, HRR=0.57)
2025-09-12 18:58:40,569 - strava_training_load - INFO - TRIMP_CALC: Average calculation completed, result=73.22
2025-09-12 18:58:40,668 - db_utils - INFO - db_utils: Database connection closed.
2025-09-12 18:58:54,202 - db_utils - INFO - db_utils: Attempting PostgreSQL connection within context manager.
2025-09-12 18:58:54,202 - db_utils - INFO - db_utils: DATABASE_URL: postgresql://appuser:trainmonk25@35.223.144.85:5432/train-d...
2025-09-12 18:58:54,202 - db_utils - INFO - db_utils: Using standard PostgreSQL connection.
2025-09-12 18:58:55,105 - db_utils - INFO - db_utils: PostgreSQL connection successful!
2025-09-12 18:58:55,324 - utils.feature_flags - INFO - \U0001f389 Enhanced TRIMP calculation access granted to user 1 (beta rollout)
2025-09-12 18:58:55,324 - utils.feature_flags - INFO - \U0001f389 Enhanced TRIMP calculation access granted to user 3 (beta rollout)
2025-09-12 18:58:55,480 - db_utils - INFO - db_utils: Database connection closed.
2025-09-12 19:02:25,242 - db_utils - INFO - db_utils: Attempting PostgreSQL connection within context manager.
2025-09-12 19:02:25,242 - db_utils - INFO - db_utils: DATABASE_URL: postgresql://appuser:trainmonk25@35.223.144.85:5432/train-d...
2025-09-12 19:02:25,243 - db_utils - INFO - db_utils: Using standard PostgreSQL connection.
2025-09-12 19:02:25,787 - db_utils - INFO - db_utils: PostgreSQL connection successful!
2025-09-12 19:02:26,230 - strava_training_load - INFO - TRIMP_CALC: Using heart rate stream data (stream_length=4089, duration=68.13min)
2025-09-12 19:02:26,231 - strava_training_load - INFO - TRIMP_CALC: Stream validation passed (valid_samples=4089, total_samples=4089)
2025-09-12 19:02:26,231 - strava_training_load - INFO - TRIMP_CALC: Duration distribution: 68.13 minutes across 4089 samples = 0.0167 minutes per sample
2025-09-12 19:02:26,231 - strava_training_load - INFO - TRIMP_CALC: Sample 0: HR=60, HRR=0.119, TRIMP=0.0016
2025-09-12 19:02:26,231 - strava_training_load - INFO - TRIMP_CALC: Sample 1: HR=60, HRR=0.119, TRIMP=0.0016
2025-09-12 19:02:26,231 - strava_training_load - INFO - TRIMP_CALC: Sample 2: HR=60, HRR=0.119, TRIMP=0.0016
2025-09-12 19:02:26,234 - strava_training_load - INFO - TRIMP_CALC: Duration distribution: 4089 valid samples, no skipped samples
2025-09-12 19:02:26,234 - strava_training_load - INFO - TRIMP_CALC: Stream calculation successful: 80.47 (samples=4089, duration=68.13, duration_per_sample=0.0167)
2025-09-12 19:02:26,234 - strava_training_load - INFO - TRIMP_CALC: Stream calculation completed, result=80.47
2025-09-12 19:02:26,234 - strava_training_load - INFO - TRIMP_CALC: Using average heart rate calculation (avg_hr=119.9, duration=68.13min)
2025-09-12 19:02:26,234 - strava_training_load - INFO - TRIMP_CALC: Average calculation successful: 73.28 (duration=68.13, avg_hr=119.9, HRR=0.57)
2025-09-12 19:02:26,234 - strava_training_load - INFO - TRIMP_CALC: Average calculation completed, result=73.28
2025-09-12 19:02:26,307 - strava_training_load - INFO - TRIMP_CALC: Using heart rate stream data (stream_length=4089, duration=68.13min)
2025-09-12 19:02:26,308 - strava_training_load - INFO - TRIMP_CALC: Stream validation passed (valid_samples=4089, total_samples=4089)
2025-09-12 19:02:26,308 - strava_training_load - INFO - TRIMP_CALC: Duration distribution: 68.13 minutes across 4089 samples = 0.0167 minutes per sample
2025-09-12 19:02:26,308 - strava_training_load - INFO - TRIMP_CALC: Sample 0: HR=60, HRR=0.119, TRIMP=0.0016
2025-09-12 19:02:26,308 - strava_training_load - INFO - TRIMP_CALC: Sample 1: HR=60, HRR=0.119, TRIMP=0.0016
2025-09-12 19:02:26,308 - strava_training_load - INFO - TRIMP_CALC: Sample 2: HR=60, HRR=0.119, TRIMP=0.0016
2025-09-12 19:02:26,311 - strava_training_load - INFO - TRIMP_CALC: Duration distribution: 4089 valid samples, no skipped samples
2025-09-12 19:02:26,311 - strava_training_load - INFO - TRIMP_CALC: Stream calculation successful: 80.47 (samples=4089, duration=68.13, duration_per_sample=0.0167)
2025-09-12 19:02:26,311 - strava_training_load - INFO - TRIMP_CALC: Stream calculation completed, result=80.47
2025-09-12 19:02:26,311 - strava_training_load - INFO - TRIMP_CALC: Using average heart rate calculation (avg_hr=119.9, duration=68.13min)
2025-09-12 19:02:26,311 - strava_training_load - INFO - TRIMP_CALC: Average calculation successful: 73.28 (duration=68.13, avg_hr=119.9, HRR=0.57)
2025-09-12 19:02:26,311 - strava_training_load - INFO - TRIMP_CALC: Average calculation completed, result=73.28
2025-09-12 19:02:26,391 - strava_training_load - INFO - TRIMP_CALC: Using heart rate stream data (stream_length=4089, duration=68.13min)
2025-09-12 19:02:26,391 - strava_training_load - INFO - TRIMP_CALC: Stream validation passed (valid_samples=4089, total_samples=4089)
2025-09-12 19:02:26,391 - strava_training_load - INFO - TRIMP_CALC: Duration distribution: 68.13 minutes across 4089 samples = 0.0167 minutes per sample
2025-09-12 19:02:26,392 - strava_training_load - INFO - TRIMP_CALC: Sample 0: HR=60, HRR=0.119, TRIMP=0.0016
2025-09-12 19:02:26,392 - strava_training_load - INFO - TRIMP_CALC: Sample 1: HR=60, HRR=0.119, TRIMP=0.0016
2025-09-12 19:02:26,392 - strava_training_load - INFO - TRIMP_CALC: Sample 2: HR=60, HRR=0.119, TRIMP=0.0016
2025-09-12 19:02:26,394 - strava_training_load - INFO - TRIMP_CALC: Duration distribution: 4089 valid samples, no skipped samples
2025-09-12 19:02:26,394 - strava_training_load - INFO - TRIMP_CALC: Stream calculation successful: 80.47 (samples=4089, duration=68.13, duration_per_sample=0.0167)
2025-09-12 19:02:26,394 - strava_training_load - INFO - TRIMP_CALC: Stream calculation completed, result=80.47
2025-09-12 19:02:26,394 - strava_training_load - INFO - TRIMP_CALC: Using average heart rate calculation (avg_hr=119.9, duration=68.13min)
2025-09-12 19:02:26,394 - strava_training_load - INFO - TRIMP_CALC: Average calculation successful: 73.28 (duration=68.13, avg_hr=119.9, HRR=0.57)
2025-09-12 19:02:26,394 - strava_training_load - INFO - TRIMP_CALC: Average calculation completed, result=73.28
2025-09-12 19:02:26,467 - strava_training_load - INFO - TRIMP_CALC: Using heart rate stream data (stream_length=5374, duration=87.65min)
2025-09-12 19:02:26,468 - strava_training_load - INFO - TRIMP_CALC: Stream validation passed (valid_samples=5374, total_samples=5374)
2025-09-12 19:02:26,468 - strava_training_load - INFO - TRIMP_CALC: Duration distribution: 87.65 minutes across 5374 samples = 0.0163 minutes per sample
2025-09-12 19:02:26,468 - strava_training_load - INFO - TRIMP_CALC: Sample 0: HR=87, HRR=0.321, TRIMP=0.0062
2025-09-12 19:02:26,468 - strava_training_load - INFO - TRIMP_CALC: Sample 1: HR=87, HRR=0.321, TRIMP=0.0062
2025-09-12 19:02:26,468 - strava_training_load - INFO - TRIMP_CALC: Sample 2: HR=87, HRR=0.321, TRIMP=0.0062
2025-09-12 19:02:26,472 - strava_training_load - INFO - TRIMP_CALC: Duration distribution: 5374 valid samples, no skipped samples
2025-09-12 19:02:26,472 - strava_training_load - INFO - TRIMP_CALC: Stream calculation successful: 152.18 (samples=5374, duration=87.65, duration_per_sample=0.0163)
2025-09-12 19:02:26,472 - strava_training_load - INFO - TRIMP_CALC: Stream calculation completed, result=152.18
2025-09-12 19:02:26,472 - strava_training_load - INFO - TRIMP_CALC: Using average heart rate calculation (avg_hr=137.2, duration=87.65min)
2025-09-12 19:02:26,472 - strava_training_load - INFO - TRIMP_CALC: Average calculation successful: 148.32 (duration=87.65, avg_hr=137.2, HRR=0.70)
2025-09-12 19:02:26,472 - strava_training_load - INFO - TRIMP_CALC: Average calculation completed, result=148.32
2025-09-12 19:02:26,543 - strava_training_load - INFO - TRIMP_CALC: Using heart rate stream data (stream_length=5374, duration=87.65min)
2025-09-12 19:02:26,543 - strava_training_load - INFO - TRIMP_CALC: Stream validation passed (valid_samples=5374, total_samples=5374)
2025-09-12 19:02:26,543 - strava_training_load - INFO - TRIMP_CALC: Duration distribution: 87.65 minutes across 5374 samples = 0.0163 minutes per sample
2025-09-12 19:02:26,543 - strava_training_load - INFO - TRIMP_CALC: Sample 0: HR=87, HRR=0.321, TRIMP=0.0062
2025-09-12 19:02:26,543 - strava_training_load - INFO - TRIMP_CALC: Sample 1: HR=87, HRR=0.321, TRIMP=0.0062
2025-09-12 19:02:26,543 - strava_training_load - INFO - TRIMP_CALC: Sample 2: HR=87, HRR=0.321, TRIMP=0.0062
2025-09-12 19:02:26,548 - strava_training_load - INFO - TRIMP_CALC: Duration distribution: 5374 valid samples, no skipped samples
2025-09-12 19:02:26,548 - strava_training_load - INFO - TRIMP_CALC: Stream calculation successful: 152.18 (samples=5374, duration=87.65, duration_per_sample=0.0163)
2025-09-12 19:02:26,548 - strava_training_load - INFO - TRIMP_CALC: Stream calculation completed, result=152.18
2025-09-12 19:02:26,548 - strava_training_load - INFO - TRIMP_CALC: Using average heart rate calculation (avg_hr=137.2, duration=87.65min)
2025-09-12 19:02:26,548 - strava_training_load - INFO - TRIMP_CALC: Average calculation successful: 148.32 (duration=87.65, avg_hr=137.2, HRR=0.70)
2025-09-12 19:02:26,548 - strava_training_load - INFO - TRIMP_CALC: Average calculation completed, result=148.32
2025-09-12 19:02:26,549 - db_utils - INFO - db_utils: Database connection closed.
2025-09-12 19:06:46,792 - db_utils - INFO - db_utils: Attempting PostgreSQL connection within context manager.
2025-09-12 19:06:46,792 - db_utils - INFO - db_utils: DATABASE_URL: postgresql://appuser:trainmonk25@35.223.144.85:5432/train-d...
2025-09-12 19:06:46,792 - db_utils - INFO - db_utils: Using standard PostgreSQL connection.
2025-09-12 19:06:47,673 - db_utils - INFO - db_utils: PostgreSQL connection successful!
2025-09-12 19:06:48,392 - strava_training_load - INFO - TRIMP_CALC: Using heart rate stream data (stream_length=4089, duration=68.13min)
2025-09-12 19:06:48,396 - strava_training_load - INFO - TRIMP_CALC: Stream validation passed (valid_samples=4089, total_samples=4089)
2025-09-12 19:06:48,396 - strava_training_load - INFO - TRIMP_CALC: Duration distribution: 68.13 minutes across 4089 samples = 0.0167 minutes per sample
2025-09-12 19:06:48,396 - strava_training_load - INFO - TRIMP_CALC: Sample 0: HR=60, HRR=0.119, TRIMP=0.0016
2025-09-12 19:06:48,396 - strava_training_load - INFO - TRIMP_CALC: Sample 1: HR=60, HRR=0.119, TRIMP=0.0016
2025-09-12 19:06:48,397 - strava_training_load - INFO - TRIMP_CALC: Sample 2: HR=60, HRR=0.119, TRIMP=0.0016
2025-09-12 19:06:48,398 - strava_training_load - INFO - TRIMP_CALC: Duration distribution: 4089 valid samples, no skipped samples
2025-09-12 19:06:48,398 - strava_training_load - INFO - TRIMP_CALC: Stream calculation successful: 80.47 (samples=4089, duration=68.13, duration_per_sample=0.0167)
2025-09-12 19:06:48,398 - strava_training_load - INFO - TRIMP_CALC: Stream calculation completed, result=80.47
2025-09-12 19:06:48,398 - strava_training_load - INFO - TRIMP_CALC: Using average heart rate calculation (avg_hr=119.9, duration=68.13min)
2025-09-12 19:06:48,398 - strava_training_load - INFO - TRIMP_CALC: Average calculation successful: 73.28 (duration=68.13, avg_hr=119.9, HRR=0.57)
2025-09-12 19:06:48,398 - strava_training_load - INFO - TRIMP_CALC: Average calculation completed, result=73.28
2025-09-12 19:06:48,464 - strava_training_load - INFO - TRIMP_CALC: Using heart rate stream data (stream_length=4089, duration=68.13min)
2025-09-12 19:06:48,480 - strava_training_load - INFO - TRIMP_CALC: Stream validation passed (valid_samples=4089, total_samples=4089)
2025-09-12 19:06:48,480 - strava_training_load - INFO - TRIMP_CALC: Duration distribution: 68.13 minutes across 4089 samples = 0.0167 minutes per sample
2025-09-12 19:06:48,480 - strava_training_load - INFO - TRIMP_CALC: Sample 0: HR=60, HRR=0.119, TRIMP=0.0016
2025-09-12 19:06:48,480 - strava_training_load - INFO - TRIMP_CALC: Sample 1: HR=60, HRR=0.119, TRIMP=0.0016
2025-09-12 19:06:48,480 - strava_training_load - INFO - TRIMP_CALC: Sample 2: HR=60, HRR=0.119, TRIMP=0.0016
2025-09-12 19:06:48,481 - strava_training_load - INFO - TRIMP_CALC: Duration distribution: 4089 valid samples, no skipped samples
2025-09-12 19:06:48,481 - strava_training_load - INFO - TRIMP_CALC: Stream calculation successful: 80.47 (samples=4089, duration=68.13, duration_per_sample=0.0167)
2025-09-12 19:06:48,481 - strava_training_load - INFO - TRIMP_CALC: Stream calculation completed, result=80.47
2025-09-12 19:06:48,481 - strava_training_load - INFO - TRIMP_CALC: Using average heart rate calculation (avg_hr=119.9, duration=68.13min)
2025-09-12 19:06:48,481 - strava_training_load - INFO - TRIMP_CALC: Average calculation successful: 73.28 (duration=68.13, avg_hr=119.9, HRR=0.57)
2025-09-12 19:06:48,481 - strava_training_load - INFO - TRIMP_CALC: Average calculation completed, result=73.28
2025-09-12 19:06:48,598 - strava_training_load - INFO - TRIMP_CALC: Using heart rate stream data (stream_length=4089, duration=68.13min)
2025-09-12 19:06:48,598 - strava_training_load - INFO - TRIMP_CALC: Stream validation passed (valid_samples=4089, total_samples=4089)
2025-09-12 19:06:48,598 - strava_training_load - INFO - TRIMP_CALC: Duration distribution: 68.13 minutes across 4089 samples = 0.0167 minutes per sample
2025-09-12 19:06:48,598 - strava_training_load - INFO - TRIMP_CALC: Sample 0: HR=60, HRR=0.119, TRIMP=0.0016
2025-09-12 19:06:48,598 - strava_training_load - INFO - TRIMP_CALC: Sample 1: HR=60, HRR=0.119, TRIMP=0.0016
2025-09-12 19:06:48,598 - strava_training_load - INFO - TRIMP_CALC: Sample 2: HR=60, HRR=0.119, TRIMP=0.0016
2025-09-12 19:06:48,598 - strava_training_load - INFO - TRIMP_CALC: Duration distribution: 4089 valid samples, no skipped samples
2025-09-12 19:06:48,598 - strava_training_load - INFO - TRIMP_CALC: Stream calculation successful: 80.47 (samples=4089, duration=68.13, duration_per_sample=0.0167)
2025-09-12 19:06:48,598 - strava_training_load - INFO - TRIMP_CALC: Stream calculation completed, result=80.47
2025-09-12 19:06:48,598 - strava_training_load - INFO - TRIMP_CALC: Using average heart rate calculation (avg_hr=119.9, duration=68.13min)
2025-09-12 19:06:48,598 - strava_training_load - INFO - TRIMP_CALC: Average calculation successful: 73.28 (duration=68.13, avg_hr=119.9, HRR=0.57)
2025-09-12 19:06:48,598 - strava_training_load - INFO - TRIMP_CALC: Average calculation completed, result=73.28
2025-09-12 19:06:48,697 - strava_training_load - INFO - TRIMP_CALC: Using heart rate stream data (stream_length=5374, duration=87.65min)
2025-09-12 19:06:48,697 - strava_training_load - INFO - TRIMP_CALC: Stream validation passed (valid_samples=5374, total_samples=5374)
2025-09-12 19:06:48,697 - strava_training_load - INFO - TRIMP_CALC: Duration distribution: 87.65 minutes across 5374 samples = 0.0163 minutes per sample
2025-09-12 19:06:48,697 - strava_training_load - INFO - TRIMP_CALC: Sample 0: HR=87, HRR=0.321, TRIMP=0.0062
2025-09-12 19:06:48,697 - strava_training_load - INFO - TRIMP_CALC: Sample 1: HR=87, HRR=0.321, TRIMP=0.0062
2025-09-12 19:06:48,697 - strava_training_load - INFO - TRIMP_CALC: Sample 2: HR=87, HRR=0.321, TRIMP=0.0062
2025-09-12 19:06:48,697 - strava_training_load - INFO - TRIMP_CALC: Duration distribution: 5374 valid samples, no skipped samples
2025-09-12 19:06:48,697 - strava_training_load - INFO - TRIMP_CALC: Stream calculation successful: 152.18 (samples=5374, duration=87.65, duration_per_sample=0.0163)
2025-09-12 19:06:48,697 - strava_training_load - INFO - TRIMP_CALC: Stream calculation completed, result=152.18
2025-09-12 19:06:48,697 - strava_training_load - INFO - TRIMP_CALC: Using average heart rate calculation (avg_hr=137.2, duration=87.65min)
2025-09-12 19:06:48,697 - strava_training_load - INFO - TRIMP_CALC: Average calculation successful: 148.32 (duration=87.65, avg_hr=137.2, HRR=0.70)
2025-09-12 19:06:48,697 - strava_training_load - INFO - TRIMP_CALC: Average calculation completed, result=148.32
2025-09-12 19:06:48,764 - strava_training_load - INFO - TRIMP_CALC: Using heart rate stream data (stream_length=5374, duration=87.65min)
2025-09-12 19:06:48,764 - strava_training_load - INFO - TRIMP_CALC: Stream validation passed (valid_samples=5374, total_samples=5374)
2025-09-12 19:06:48,764 - strava_training_load - INFO - TRIMP_CALC: Duration distribution: 87.65 minutes across 5374 samples = 0.0163 minutes per sample
2025-09-12 19:06:48,764 - strava_training_load - INFO - TRIMP_CALC: Sample 0: HR=87, HRR=0.321, TRIMP=0.0062
2025-09-12 19:06:48,764 - strava_training_load - INFO - TRIMP_CALC: Sample 1: HR=87, HRR=0.321, TRIMP=0.0062
2025-09-12 19:06:48,764 - strava_training_load - INFO - TRIMP_CALC: Sample 2: HR=87, HRR=0.321, TRIMP=0.0062
2025-09-12 19:06:48,776 - strava_training_load - INFO - TRIMP_CALC: Duration distribution: 5374 valid samples, no skipped samples
2025-09-12 19:06:48,776 - strava_training_load - INFO - TRIMP_CALC: Stream calculation successful: 152.18 (samples=5374, duration=87.65, duration_per_sample=0.0163)
2025-09-12 19:06:48,776 - strava_training_load - INFO - TRIMP_CALC: Stream calculation completed, result=152.18
2025-09-12 19:06:48,776 - strava_training_load - INFO - TRIMP_CALC: Using average heart rate calculation (avg_hr=137.2, duration=87.65min)
2025-09-12 19:06:48,776 - strava_training_load - INFO - TRIMP_CALC: Average calculation successful: 148.32 (duration=87.65, avg_hr=137.2, HRR=0.70)
2025-09-12 19:06:48,776 - strava_training_load - INFO - TRIMP_CALC: Average calculation completed, result=148.32
2025-09-12 19:06:48,776 - db_utils - INFO - db_utils: Database connection closed.
2025-09-12 19:13:50,663 - db_utils - INFO - db_utils: Attempting PostgreSQL connection within context manager.
2025-09-12 19:13:50,663 - db_utils - INFO - db_utils: DATABASE_URL: postgresql://appuser:trainmonk25@35.223.144.85:5432/train-d...
2025-09-12 19:13:50,663 - db_utils - INFO - db_utils: Using standard PostgreSQL connection.
2025-09-12 19:13:51,279 - db_utils - INFO - db_utils: PostgreSQL connection successful!
2025-09-12 19:13:51,691 - strava_training_load - INFO - TRIMP_CALC: Using heart rate stream data (stream_length=4089, duration=68.13min)
2025-09-12 19:13:51,691 - strava_training_load - INFO - TRIMP_CALC: Stream validation passed (valid_samples=4089, total_samples=4089)
2025-09-12 19:13:51,691 - strava_training_load - INFO - TRIMP_CALC: Duration distribution: 68.13 minutes across 4089 samples = 0.0167 minutes per sample
2025-09-12 19:13:51,691 - strava_training_load - INFO - TRIMP_CALC: Sample 0: HR=60, HRR=0.119, TRIMP=0.0016
2025-09-12 19:13:51,691 - strava_training_load - INFO - TRIMP_CALC: Sample 1: HR=60, HRR=0.119, TRIMP=0.0016
2025-09-12 19:13:51,691 - strava_training_load - INFO - TRIMP_CALC: Sample 2: HR=60, HRR=0.119, TRIMP=0.0016
2025-09-12 19:13:51,693 - strava_training_load - INFO - TRIMP_CALC: Duration distribution: 4089 valid samples, no skipped samples
2025-09-12 19:13:51,693 - strava_training_load - INFO - TRIMP_CALC: Stream calculation successful: 80.47 (samples=4089, duration=68.13, duration_per_sample=0.0167)
2025-09-12 19:13:51,693 - strava_training_load - INFO - TRIMP_CALC: Stream calculation completed, result=80.47
2025-09-12 19:13:51,693 - strava_training_load - INFO - TRIMP_CALC: Using average heart rate calculation (avg_hr=119.9, duration=68.13min)
2025-09-12 19:13:51,693 - strava_training_load - INFO - TRIMP_CALC: Average calculation successful: 73.28 (duration=68.13, avg_hr=119.9, HRR=0.57)
2025-09-12 19:13:51,693 - strava_training_load - INFO - TRIMP_CALC: Average calculation completed, result=73.28
2025-09-12 19:13:51,775 - strava_training_load - INFO - TRIMP_CALC: Using heart rate stream data (stream_length=4089, duration=68.13min)
2025-09-12 19:13:51,775 - strava_training_load - INFO - TRIMP_CALC: Stream validation passed (valid_samples=4089, total_samples=4089)
2025-09-12 19:13:51,775 - strava_training_load - INFO - TRIMP_CALC: Duration distribution: 68.13 minutes across 4089 samples = 0.0167 minutes per sample
2025-09-12 19:13:51,775 - strava_training_load - INFO - TRIMP_CALC: Sample 0: HR=60, HRR=0.119, TRIMP=0.0016
2025-09-12 19:13:51,775 - strava_training_load - INFO - TRIMP_CALC: Sample 1: HR=60, HRR=0.119, TRIMP=0.0016
2025-09-12 19:13:51,775 - strava_training_load - INFO - TRIMP_CALC: Sample 2: HR=60, HRR=0.119, TRIMP=0.0016
2025-09-12 19:13:51,780 - strava_training_load - INFO - TRIMP_CALC: Duration distribution: 4089 valid samples, no skipped samples
2025-09-12 19:13:51,780 - strava_training_load - INFO - TRIMP_CALC: Stream calculation successful: 80.47 (samples=4089, duration=68.13, duration_per_sample=0.0167)
2025-09-12 19:13:51,780 - strava_training_load - INFO - TRIMP_CALC: Stream calculation completed, result=80.47
2025-09-12 19:13:51,780 - strava_training_load - INFO - TRIMP_CALC: Using average heart rate calculation (avg_hr=119.9, duration=68.13min)
2025-09-12 19:13:51,780 - strava_training_load - INFO - TRIMP_CALC: Average calculation successful: 73.28 (duration=68.13, avg_hr=119.9, HRR=0.57)
2025-09-12 19:13:51,780 - strava_training_load - INFO - TRIMP_CALC: Average calculation completed, result=73.28
2025-09-12 19:13:51,847 - strava_training_load - INFO - TRIMP_CALC: Using heart rate stream data (stream_length=4089, duration=68.13min)
2025-09-12 19:13:51,851 - strava_training_load - INFO - TRIMP_CALC: Stream validation passed (valid_samples=4089, total_samples=4089)
2025-09-12 19:13:51,851 - strava_training_load - INFO - TRIMP_CALC: Duration distribution: 68.13 minutes across 4089 samples = 0.0167 minutes per sample
2025-09-12 19:13:51,851 - strava_training_load - INFO - TRIMP_CALC: Sample 0: HR=60, HRR=0.119, TRIMP=0.0016
2025-09-12 19:13:51,851 - strava_training_load - INFO - TRIMP_CALC: Sample 1: HR=60, HRR=0.119, TRIMP=0.0016
2025-09-12 19:13:51,851 - strava_training_load - INFO - TRIMP_CALC: Sample 2: HR=60, HRR=0.119, TRIMP=0.0016
2025-09-12 19:13:51,854 - strava_training_load - INFO - TRIMP_CALC: Duration distribution: 4089 valid samples, no skipped samples
2025-09-12 19:13:51,854 - strava_training_load - INFO - TRIMP_CALC: Stream calculation successful: 80.47 (samples=4089, duration=68.13, duration_per_sample=0.0167)
2025-09-12 19:13:51,854 - strava_training_load - INFO - TRIMP_CALC: Stream calculation completed, result=80.47
2025-09-12 19:13:51,854 - strava_training_load - INFO - TRIMP_CALC: Using average heart rate calculation (avg_hr=119.9, duration=68.13min)
2025-09-12 19:13:51,854 - strava_training_load - INFO - TRIMP_CALC: Average calculation successful: 73.28 (duration=68.13, avg_hr=119.9, HRR=0.57)
2025-09-12 19:13:51,854 - strava_training_load - INFO - TRIMP_CALC: Average calculation completed, result=73.28
2025-09-12 19:13:51,930 - db_utils - INFO - db_utils: Database connection closed.
2025-09-12 19:14:29,618 - db_utils - INFO - db_utils: Attempting PostgreSQL connection within context manager.
2025-09-12 19:14:29,618 - db_utils - INFO - db_utils: DATABASE_URL: postgresql://appuser:trainmonk25@35.223.144.85:5432/train-d...
2025-09-12 19:14:29,618 - db_utils - INFO - db_utils: Using standard PostgreSQL connection.
2025-09-12 19:14:30,125 - db_utils - INFO - db_utils: PostgreSQL connection successful!
2025-09-12 19:14:30,292 - db_utils - ERROR - db_utils: Database connection error: operator does not exist: bigint = text
LINE 8:                     WHERE a.activity_id = ANY(ARRAY['1576771...
                                                ^
HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
Traceback (most recent call last):
  File "C:\Users\robho\Documents\TrainingMonkey-Clean\app\db_utils.py", line 97, in get_db_connection
    yield conn
  File "C:\Users\robho\Documents\TrainingMonkey-Clean\check_screenshot_activities.py", line 31, in check_screenshot_activities
    cursor.execute("""
  File "C:\Users\robho\AppData\Roaming\Python\Python311\site-packages\psycopg2\extras.py", line 236, in execute
    return super().execute(query, vars)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
psycopg2.errors.UndefinedFunction: operator does not exist: bigint = text
LINE 8:                     WHERE a.activity_id = ANY(ARRAY['1576771...
                                                ^
HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.

2025-09-12 19:14:30,359 - db_utils - INFO - db_utils: Database connection closed.
2025-09-12 19:14:36,080 - db_utils - INFO - db_utils: Attempting PostgreSQL connection within context manager.
2025-09-12 19:14:36,080 - db_utils - INFO - db_utils: DATABASE_URL: postgresql://appuser:trainmonk25@35.223.144.85:5432/train-d...
2025-09-12 19:14:36,080 - db_utils - INFO - db_utils: Using standard PostgreSQL connection.
2025-09-12 19:14:36,761 - db_utils - INFO - db_utils: PostgreSQL connection successful!
2025-09-12 19:14:37,068 - db_utils - INFO - db_utils: Database connection closed.
2025-09-13 09:14:23,567 - db_utils - INFO - db_utils: Attempting PostgreSQL connection within context manager.
2025-09-13 09:14:23,567 - db_utils - INFO - db_utils: DATABASE_URL: postgresql://appuser:trainmonk25@35.223.144.85:5432/train-d...
2025-09-13 09:14:23,567 - db_utils - INFO - db_utils: Using standard PostgreSQL connection.
2025-09-13 09:14:24,325 - db_utils - INFO - db_utils: PostgreSQL connection successful!
2025-09-13 09:14:24,541 - db_utils - INFO - db_utils: Retrieving HR stream data for activity 15743720183
2025-09-13 09:14:24,541 - db_utils - INFO - db_utils: Attempting PostgreSQL connection within context manager.
2025-09-13 09:14:24,541 - db_utils - INFO - db_utils: DATABASE_URL: postgresql://appuser:trainmonk25@35.223.144.85:5432/train-d...
2025-09-13 09:14:24,541 - db_utils - INFO - db_utils: Using standard PostgreSQL connection.
2025-09-13 09:14:25,242 - db_utils - INFO - db_utils: PostgreSQL connection successful!
2025-09-13 09:14:25,559 - db_utils - INFO - db_utils: Database connection closed.
2025-09-13 09:14:25,559 - db_utils - INFO - db_utils: No HR stream data found for activity 15743720183
2025-09-13 09:14:25,559 - utils.feature_flags - INFO - \U0001f389 Enhanced TRIMP calculation access granted to user 1 (beta rollout)
2025-09-13 09:14:25,559 - db_utils - INFO - db_utils: Attempting PostgreSQL connection within context manager.
2025-09-13 09:14:25,559 - db_utils - INFO - db_utils: DATABASE_URL: postgresql://appuser:trainmonk25@35.223.144.85:5432/train-d...
2025-09-13 09:14:25,559 - db_utils - INFO - db_utils: Using standard PostgreSQL connection.
2025-09-13 09:14:26,503 - db_utils - INFO - db_utils: PostgreSQL connection successful!
2025-09-13 09:14:26,793 - db_utils - INFO - db_utils: Database connection closed.
2025-09-13 09:14:26,793 - enhanced_token_management - INFO - Getting working Strava client for user 1...
2025-09-13 09:14:26,810 - db_utils - INFO - db_utils: Attempting PostgreSQL connection within context manager.
2025-09-13 09:14:26,810 - db_utils - INFO - db_utils: DATABASE_URL: postgresql://appuser:trainmonk25@35.223.144.85:5432/train-d...
2025-09-13 09:14:26,810 - db_utils - INFO - db_utils: Using standard PostgreSQL connection.
2025-09-13 09:14:27,512 - db_utils - INFO - db_utils: PostgreSQL connection successful!
2025-09-13 09:14:27,812 - db_utils - INFO - db_utils: Database connection closed.
2025-09-13 09:14:27,812 - secure_token_storage - INFO - Securely loading tokens for user 1
2025-09-13 09:14:27,812 - db_utils - INFO - db_utils: Attempting PostgreSQL connection within context manager.
2025-09-13 09:14:27,812 - db_utils - INFO - db_utils: DATABASE_URL: postgresql://appuser:trainmonk25@35.223.144.85:5432/train-d...
2025-09-13 09:14:27,812 - db_utils - INFO - db_utils: Using standard PostgreSQL connection.
2025-09-13 09:14:28,529 - db_utils - INFO - db_utils: PostgreSQL connection successful!
2025-09-13 09:14:28,828 - db_utils - INFO - db_utils: Database connection closed.
2025-09-13 09:14:28,845 - db_utils - INFO - db_utils: Attempting PostgreSQL connection within context manager.
2025-09-13 09:14:28,852 - db_utils - INFO - db_utils: DATABASE_URL: postgresql://appuser:trainmonk25@35.223.144.85:5432/train-d...
2025-09-13 09:14:28,852 - db_utils - INFO - db_utils: Using standard PostgreSQL connection.
2025-09-13 09:14:29,530 - db_utils - INFO - db_utils: PostgreSQL connection successful!
2025-09-13 09:14:29,653 - db_utils - ERROR - db_utils: Database connection error: not all arguments converted during string formatting
Traceback (most recent call last):
  File "C:\Users\robho\Documents\TrainingMonkey-Clean\app\db_utils.py", line 97, in get_db_connection
    yield conn
  File "C:\Users\robho\Documents\TrainingMonkey-Clean\app\db_utils.py", line 130, in execute_query
    cursor.execute(query, params)
  File "C:\Users\robho\AppData\Roaming\Python\Python311\site-packages\psycopg2\extras.py", line 236, in execute
    return super().execute(query, vars)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: not all arguments converted during string formatting
2025-09-13 09:14:29,729 - db_utils - INFO - db_utils: Database connection closed.
2025-09-13 09:14:29,729 - db_utils - ERROR - db_utils: Query failed: not all arguments converted during string formatting
2025-09-13 09:14:29,729 - db_utils - ERROR - db_utils: Query was: INSERT INTO token_audit_log 
                   (user_id, operation, success, timestamp, ip_address, user_agent, details)
                   VALUES (%s)
2025-09-13 09:14:29,729 - db_utils - ERROR - db_utils: Params were: (1, 'load_tokens', True, '2025-09-13T09:14:28.845014', 'unknown', 'unknown', '{"operation": "token_load", "user_id": 1, "source": "enhanced_token_management"}')
2025-09-13 09:14:29,729 - secure_token_storage - ERROR - Error logging token operation: not all arguments converted during string formatting
2025-09-13 09:14:29,729 - secure_token_storage - INFO - Tokens securely loaded for user 1
2025-09-13 09:14:29,729 - enhanced_token_management - INFO - Tokens loaded securely for user 1
2025-09-13 09:14:29,729 - enhanced_token_management - INFO - Token still valid - expires in 4 hours
2025-09-13 09:14:29,729 - root - WARNING - Please make sure your STRAVA_CLIENT_ID is set in your environment.Add SILENCE_TOKEN_WARNINGS=true to your environment to disable this error.
2025-09-13 09:14:29,729 - root - WARNING - STRAVA_CLIENT_ID and STRAVA_CLIENT_SECRET not found in your  environment. Please refresh your access_token manually. Or add STRAVA_CLIENT_ID and STRAVA_CLIENT_SECRET to your environment.Add SILENCE_TOKEN_WARNINGS=true to your environment to silence this warning.
2025-09-13 09:14:29,729 - enhanced_token_management - INFO - Client created without validation for user 1
2025-09-13 09:14:29,729 - historical_trimp_recalculation - INFO - Fetching Strava activity 15743720183 for user 1
2025-09-13 09:14:29,729 - stravalib.protocol.ApiV3 - INFO - GET 'https://www.strava.com/api/v3/activities/15743720183' with params {'include_all_efforts': False}
2025-09-13 09:14:31,447 - historical_trimp_recalculation - INFO - Successfully retrieved Strava activity 15743720183
2025-09-13 09:14:31,447 - strava_training_load - INFO - DEBUG: Starting calculate_training_load for activity 15743720183: 'Morning Trail Run'
2025-09-13 09:14:31,447 - strava_training_load - INFO - Determining activity type for 15743720183: 'Morning Trail Run'
2025-09-13 09:14:31,447 - strava_training_load - INFO - Raw sport_type: root='TrailRun', Cleaned: TrailRun
2025-09-13 09:14:31,447 - strava_training_load - INFO - Raw type: root='Run', Cleaned: Run
2025-09-13 09:14:31,447 - strava_training_load - INFO - Final activity type for 15743720183: 'Trail Run'
2025-09-13 09:14:31,447 - strava_training_load - INFO - Determining activity type for 15743720183: 'Morning Trail Run'
2025-09-13 09:14:31,447 - strava_training_load - INFO - Raw sport_type: root='TrailRun', Cleaned: TrailRun
2025-09-13 09:14:31,447 - strava_training_load - INFO - Raw type: root='Run', Cleaned: Run
2025-09-13 09:14:31,447 - strava_training_load - INFO - Final activity type for 15743720183: 'Trail Run'
2025-09-13 09:14:31,447 - strava_training_load - INFO - Determining sport type for activity type: 'Trail Run'
2025-09-13 09:14:31,447 - strava_training_load - INFO - Activity classified as 'running': Trail Run
2025-09-13 09:14:31,447 - strava_training_load - INFO - DEBUG: Activity 15743720183 type: 'Trail Run' -> sport: 'running'
2025-09-13 09:14:31,447 - strava_training_load - INFO - DEBUG: Calculated average speed: 5.36 mph
2025-09-13 09:14:31,447 - strava_training_load - INFO - DEBUG: Using running external load calculation
2025-09-13 09:14:31,447 - strava_training_load - INFO - DEBUG: External load calculated: distance=7.57, elevation_load=2.26, total=9.83
2025-09-13 09:14:31,447 - strava_training_load - INFO - Fetching streams for activity 15743720183
2025-09-13 09:14:31,447 - stravalib.protocol.ApiV3 - INFO - GET 'https://www.strava.com/api/v3/activities/15743720183/streams' with params {'keys': 'time,distance,heartrate,altitude,velocity_smooth,cadence,watts,temp,moving,grade_smooth', 'key_by_type': True}
2025-09-13 09:14:31,713 - stravalib.util.limiter.SleepingRateLimitRule - WARNING - No rates present in response headers
2025-09-13 09:14:31,730 - strava_training_load - INFO - Successfully fetched streams for activity 15743720183: ['altitude', 'watts', 'moving', 'cadence', 'velocity_smooth', 'time', 'heartrate', 'grade_smooth', 'distance']
2025-09-13 09:14:31,730 - strava_training_load - INFO - Heartrate stream data available: 5218 samples
2025-09-13 09:14:31,730 - strava_training_load - INFO - Streams retrieved for activity 15743720183: ['altitude', 'watts', 'moving', 'cadence', 'velocity_smooth', 'time', 'heartrate', 'grade_smooth', 'distance']
2025-09-13 09:14:31,730 - strava_training_load - INFO - HR zone times (seconds): [518, 2099, 2325, 138, 0]
2025-09-13 09:14:31,730 - strava_training_load - INFO - Retrieved HR stream data: 5218 samples for activity 15743720183
2025-09-13 09:14:31,730 - db_utils - INFO - db_utils: Saving HR stream data for activity 15743720183, user 1
2025-09-13 09:14:31,730 - db_utils - INFO - db_utils: Attempting PostgreSQL connection within context manager.
2025-09-13 09:14:31,730 - db_utils - INFO - db_utils: DATABASE_URL: postgresql://appuser:trainmonk25@35.223.144.85:5432/train-d...
2025-09-13 09:14:31,730 - db_utils - INFO - db_utils: Using standard PostgreSQL connection.
2025-09-13 09:14:32,414 - db_utils - INFO - db_utils: PostgreSQL connection successful!
2025-09-13 09:14:33,448 - db_utils - INFO - db_utils: Database connection closed.
2025-09-13 09:14:33,448 - db_utils - INFO - db_utils: Successfully saved HR stream data for activity 15743720183 (5218 samples)
2025-09-13 09:14:33,448 - strava_training_load - INFO - Successfully saved HR stream data for activity 15743720183
2025-09-13 09:14:33,448 - utils.feature_flags - INFO - \U0001f389 Enhanced TRIMP calculation access granted to user 1 (beta rollout)
2025-09-13 09:14:33,448 - strava_training_load - INFO - Using enhanced TRIMP calculation for user 1, activity 15743720183
2025-09-13 09:14:33,448 - strava_training_load - INFO - TRIMP_CALC: Using heart rate stream data (stream_length=5218, duration=84.83333333333333min)
2025-09-13 09:14:33,448 - strava_training_load - INFO - TRIMP_CALC: Stream validation passed (valid_samples=5218, total_samples=5218)
2025-09-13 09:14:33,448 - strava_training_load - INFO - TRIMP_CALC: Duration distribution: 84.83333333333333 minutes across 5218 samples = 0.0163 minutes per sample
2025-09-13 09:14:33,448 - strava_training_load - INFO - TRIMP_CALC: Sample 0: HR=91, HRR=0.351, TRIMP=0.0072
2025-09-13 09:14:33,448 - strava_training_load - INFO - TRIMP_CALC: Sample 1: HR=91, HRR=0.351, TRIMP=0.0072
2025-09-13 09:14:33,448 - strava_training_load - INFO - TRIMP_CALC: Sample 2: HR=92, HRR=0.358, TRIMP=0.0074
2025-09-13 09:14:33,448 - strava_training_load - INFO - TRIMP_CALC: Duration distribution: 5218 valid samples, no skipped samples
2025-09-13 09:14:33,448 - strava_training_load - INFO - TRIMP_CALC: Stream calculation successful: 143.58 (samples=5218, duration=84.83333333333333, duration_per_sample=0.0163)
2025-09-13 09:14:33,448 - strava_training_load - INFO - TRIMP_CALC: Stream calculation completed, result=143.58
2025-09-13 09:14:33,448 - strava_training_load - INFO - DEBUG: Activity 15743720183 final data:
2025-09-13 09:14:33,448 - strava_training_load - INFO -   - Name: 'Morning Trail Run'
2025-09-13 09:14:33,448 - strava_training_load - INFO -   - Type: 'Trail Run' (Sport: running)
2025-09-13 09:14:33,448 - strava_training_load - INFO -   - Distance: 7.57 miles
2025-09-13 09:14:33,448 - strava_training_load - INFO -   - Elevation: 1696.2 feet
2025-09-13 09:14:33,448 - strava_training_load - INFO -   - Duration: 84.8 minutes
2025-09-13 09:14:33,448 - strava_training_load - INFO -   - Average Speed: 5.36 mph
2025-09-13 09:14:33,448 - strava_training_load - INFO -   - TRIMP: 143.58
2025-09-13 09:14:33,448 - strava_training_load - INFO - DEBUG: Returning result for activity 15743720183 with type='Trail Run', sport='running'
2025-09-13 09:14:33,448 - db_utils - INFO - db_utils: Updating TRIMP metadata for activity 15743720183
2025-09-13 09:14:33,448 - db_utils - INFO - db_utils: Attempting PostgreSQL connection within context manager.
2025-09-13 09:14:33,448 - db_utils - INFO - db_utils: DATABASE_URL: postgresql://appuser:trainmonk25@35.223.144.85:5432/train-d...
2025-09-13 09:14:33,448 - db_utils - INFO - db_utils: Using standard PostgreSQL connection.
2025-09-13 09:14:34,015 - db_utils - INFO - db_utils: PostgreSQL connection successful!
2025-09-13 09:14:34,145 - db_utils - ERROR - db_utils: Database connection error: tuple index out of range
Traceback (most recent call last):
  File "C:\Users\robho\Documents\TrainingMonkey-Clean\app\db_utils.py", line 97, in get_db_connection
    yield conn
  File "C:\Users\robho\Documents\TrainingMonkey-Clean\app\db_utils.py", line 130, in execute_query
    cursor.execute(query, params)
  File "C:\Users\robho\AppData\Roaming\Python\Python311\site-packages\psycopg2\extras.py", line 236, in execute
    return super().execute(query, vars)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
IndexError: tuple index out of range
2025-09-13 09:14:34,199 - db_utils - INFO - db_utils: Database connection closed.
2025-09-13 09:14:34,214 - db_utils - ERROR - db_utils: Query failed: tuple index out of range
2025-09-13 09:14:34,214 - db_utils - ERROR - db_utils: Query was: 
            UPDATE activities 
            SET %s = %s, trimp_calculation_method = %s, 
                hr_stream_sample_count = %s, 
                trimp_processed_at = CURRENT_TIMESTAMP
            WHERE activity_id = %s AND user_id = %s
        
2025-09-13 09:14:34,214 - db_utils - ERROR - db_utils: Params were: (143.58, 'average', 5218, 15743720183, 1)
2025-09-13 09:14:34,214 - db_utils - ERROR - db_utils: Error updating TRIMP metadata for activity 15743720183: tuple index out of range
2025-09-13 09:14:34,216 - db_utils - ERROR - db_utils: Database connection error: 'RecalculationResult' object has no attribute 'error'
Traceback (most recent call last):
  File "C:\Users\robho\Documents\TrainingMonkey-Clean\app\db_utils.py", line 97, in get_db_connection
    yield conn
  File "C:\Users\robho\Documents\TrainingMonkey-Clean\test_hr_stream_recalculation.py", line 76, in test_hr_stream_recalculation
    print(f"  Error: {result.error}")
                      ^^^^^^^^^^^^
AttributeError: 'RecalculationResult' object has no attribute 'error'
2025-09-13 09:14:34,282 - db_utils - INFO - db_utils: Database connection closed.
2025-09-13 09:14:55,425 - db_utils - INFO - db_utils: Attempting PostgreSQL connection within context manager.
2025-09-13 09:14:55,425 - db_utils - INFO - db_utils: DATABASE_URL: postgresql://appuser:trainmonk25@35.223.144.85:5432/train-d...
2025-09-13 09:14:55,425 - db_utils - INFO - db_utils: Using standard PostgreSQL connection.
2025-09-13 09:14:56,065 - db_utils - INFO - db_utils: PostgreSQL connection successful!
2025-09-13 09:14:56,485 - db_utils - INFO - db_utils: Database connection closed.
2025-09-13 09:15:05,503 - db_utils - INFO - db_utils: Attempting PostgreSQL connection within context manager.
2025-09-13 09:15:05,503 - db_utils - INFO - db_utils: DATABASE_URL: postgresql://appuser:trainmonk25@35.223.144.85:5432/train-d...
2025-09-13 09:15:05,503 - db_utils - INFO - db_utils: Using standard PostgreSQL connection.
2025-09-13 09:15:06,073 - db_utils - INFO - db_utils: PostgreSQL connection successful!
2025-09-13 09:15:06,397 - enhanced_token_management - INFO - Getting working Strava client for user 1...
2025-09-13 09:15:06,398 - db_utils - INFO - db_utils: Attempting PostgreSQL connection within context manager.
2025-09-13 09:15:06,398 - db_utils - INFO - db_utils: DATABASE_URL: postgresql://appuser:trainmonk25@35.223.144.85:5432/train-d...
2025-09-13 09:15:06,399 - db_utils - INFO - db_utils: Using standard PostgreSQL connection.
2025-09-13 09:15:07,407 - db_utils - INFO - db_utils: PostgreSQL connection successful!
2025-09-13 09:15:08,676 - db_utils - INFO - db_utils: Database connection closed.
2025-09-13 09:15:08,676 - secure_token_storage - INFO - Securely loading tokens for user 1
2025-09-13 09:15:08,676 - db_utils - INFO - db_utils: Attempting PostgreSQL connection within context manager.
2025-09-13 09:15:08,676 - db_utils - INFO - db_utils: DATABASE_URL: postgresql://appuser:trainmonk25@35.223.144.85:5432/train-d...
2025-09-13 09:15:08,676 - db_utils - INFO - db_utils: Using standard PostgreSQL connection.
2025-09-13 09:15:09,392 - db_utils - INFO - db_utils: PostgreSQL connection successful!
2025-09-13 09:15:09,697 - db_utils - INFO - db_utils: Database connection closed.
2025-09-13 09:15:09,697 - db_utils - INFO - db_utils: Attempting PostgreSQL connection within context manager.
2025-09-13 09:15:09,697 - db_utils - INFO - db_utils: DATABASE_URL: postgresql://appuser:trainmonk25@35.223.144.85:5432/train-d...
2025-09-13 09:15:09,697 - db_utils - INFO - db_utils: Using standard PostgreSQL connection.
2025-09-13 09:15:11,133 - db_utils - INFO - db_utils: PostgreSQL connection successful!
2025-09-13 09:15:11,440 - db_utils - ERROR - db_utils: Database connection error: not all arguments converted during string formatting
Traceback (most recent call last):
  File "C:\Users\robho\Documents\TrainingMonkey-Clean\app\db_utils.py", line 97, in get_db_connection
    yield conn
  File "C:\Users\robho\Documents\TrainingMonkey-Clean\app\db_utils.py", line 130, in execute_query
    cursor.execute(query, params)
  File "C:\Users\robho\AppData\Roaming\Python\Python311\site-packages\psycopg2\extras.py", line 236, in execute
    return super().execute(query, vars)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: not all arguments converted during string formatting
2025-09-13 09:15:11,745 - db_utils - INFO - db_utils: Database connection closed.
2025-09-13 09:15:11,745 - db_utils - ERROR - db_utils: Query failed: not all arguments converted during string formatting
2025-09-13 09:15:11,745 - db_utils - ERROR - db_utils: Query was: INSERT INTO token_audit_log 
                   (user_id, operation, success, timestamp, ip_address, user_agent, details)
                   VALUES (%s)
2025-09-13 09:15:11,745 - db_utils - ERROR - db_utils: Params were: (1, 'load_tokens', True, '2025-09-13T09:15:09.697195', 'unknown', 'unknown', '{"operation": "token_load", "user_id": 1, "source": "enhanced_token_management"}')
2025-09-13 09:15:11,745 - secure_token_storage - ERROR - Error logging token operation: not all arguments converted during string formatting
2025-09-13 09:15:11,745 - secure_token_storage - INFO - Tokens securely loaded for user 1
2025-09-13 09:15:11,745 - enhanced_token_management - INFO - Tokens loaded securely for user 1
2025-09-13 09:15:11,745 - enhanced_token_management - INFO - Token still valid - expires in 4 hours
2025-09-13 09:15:11,745 - root - WARNING - Please make sure your STRAVA_CLIENT_ID is set in your environment.Add SILENCE_TOKEN_WARNINGS=true to your environment to disable this error.
2025-09-13 09:15:11,745 - root - WARNING - STRAVA_CLIENT_ID and STRAVA_CLIENT_SECRET not found in your  environment. Please refresh your access_token manually. Or add STRAVA_CLIENT_ID and STRAVA_CLIENT_SECRET to your environment.Add SILENCE_TOKEN_WARNINGS=true to your environment to silence this warning.
2025-09-13 09:15:11,745 - stravalib.protocol.ApiV3 - INFO - GET 'https://www.strava.com/api/v3/athlete' with params {}
2025-09-13 09:15:13,481 - enhanced_token_management - INFO - Successfully connected as Rob Houghton for user 1
2025-09-13 09:15:13,481 - stravalib.protocol.ApiV3 - INFO - GET 'https://www.strava.com/api/v3/activities/15743720183' with params {'include_all_efforts': False}
2025-09-13 09:15:14,229 - strava_training_load - INFO - Fetching streams for activity 15743720183
2025-09-13 09:15:14,229 - stravalib.protocol.ApiV3 - INFO - GET 'https://www.strava.com/api/v3/activities/15743720183/streams' with params {'keys': 'time,distance,heartrate,altitude,velocity_smooth,cadence,watts,temp,moving,grade_smooth', 'key_by_type': True}
2025-09-13 09:15:14,594 - stravalib.util.limiter.SleepingRateLimitRule - WARNING - No rates present in response headers
2025-09-13 09:15:14,596 - strava_training_load - INFO - Successfully fetched streams for activity 15743720183: ['altitude', 'watts', 'moving', 'cadence', 'velocity_smooth', 'time', 'heartrate', 'grade_smooth', 'distance']
2025-09-13 09:15:14,596 - strava_training_load - INFO - Heartrate stream data available: 5218 samples
2025-09-13 09:15:14,596 - db_utils - INFO - db_utils: Saving HR stream data for activity 15743720183, user 1
2025-09-13 09:15:14,596 - db_utils - INFO - db_utils: Attempting PostgreSQL connection within context manager.
2025-09-13 09:15:14,596 - db_utils - INFO - db_utils: DATABASE_URL: postgresql://appuser:trainmonk25@35.223.144.85:5432/train-d...
2025-09-13 09:15:14,596 - db_utils - INFO - db_utils: Using standard PostgreSQL connection.
2025-09-13 09:15:15,312 - db_utils - INFO - db_utils: PostgreSQL connection successful!
2025-09-13 09:15:15,863 - db_utils - INFO - db_utils: Database connection closed.
2025-09-13 09:15:15,863 - db_utils - INFO - db_utils: Successfully saved HR stream data for activity 15743720183 (5218 samples)
2025-09-13 09:15:15,863 - db_utils - INFO - db_utils: Retrieving HR stream data for activity 15743720183
2025-09-13 09:15:15,863 - db_utils - INFO - db_utils: Attempting PostgreSQL connection within context manager.
2025-09-13 09:15:15,863 - db_utils - INFO - db_utils: DATABASE_URL: postgresql://appuser:trainmonk25@35.223.144.85:5432/train-d...
2025-09-13 09:15:15,863 - db_utils - INFO - db_utils: Using standard PostgreSQL connection.
2025-09-13 09:15:16,384 - db_utils - INFO - db_utils: PostgreSQL connection successful!
2025-09-13 09:15:16,664 - db_utils - INFO - db_utils: Database connection closed.
2025-09-13 09:15:16,664 - db_utils - INFO - db_utils: Retrieved HR stream data for activity 15743720183 (5218 samples)
2025-09-13 09:15:16,664 - db_utils - INFO - db_utils: Database connection closed.
2025-09-13 09:15:46,652 - db_utils - INFO - db_utils: Attempting PostgreSQL connection within context manager.
2025-09-13 09:15:46,652 - db_utils - INFO - db_utils: DATABASE_URL: postgresql://appuser:trainmonk25@35.223.144.85:5432/train-d...
2025-09-13 09:15:46,652 - db_utils - INFO - db_utils: Using standard PostgreSQL connection.
2025-09-13 09:15:47,470 - db_utils - INFO - db_utils: PostgreSQL connection successful!
2025-09-13 09:15:47,687 - enhanced_token_management - INFO - Getting working Strava client for user 1...
2025-09-13 09:15:47,689 - db_utils - INFO - db_utils: Attempting PostgreSQL connection within context manager.
2025-09-13 09:15:47,689 - db_utils - INFO - db_utils: DATABASE_URL: postgresql://appuser:trainmonk25@35.223.144.85:5432/train-d...
2025-09-13 09:15:47,689 - db_utils - INFO - db_utils: Using standard PostgreSQL connection.
2025-09-13 09:15:48,405 - db_utils - INFO - db_utils: PostgreSQL connection successful!
2025-09-13 09:15:48,687 - db_utils - INFO - db_utils: Database connection closed.
2025-09-13 09:15:48,687 - secure_token_storage - INFO - Securely loading tokens for user 1
2025-09-13 09:15:48,687 - db_utils - INFO - db_utils: Attempting PostgreSQL connection within context manager.
2025-09-13 09:15:48,687 - db_utils - INFO - db_utils: DATABASE_URL: postgresql://appuser:trainmonk25@35.223.144.85:5432/train-d...
2025-09-13 09:15:48,687 - db_utils - INFO - db_utils: Using standard PostgreSQL connection.
2025-09-13 09:15:49,621 - db_utils - INFO - db_utils: PostgreSQL connection successful!
2025-09-13 09:15:49,940 - db_utils - INFO - db_utils: Database connection closed.
2025-09-13 09:15:49,941 - db_utils - INFO - db_utils: Attempting PostgreSQL connection within context manager.
2025-09-13 09:15:49,941 - db_utils - INFO - db_utils: DATABASE_URL: postgresql://appuser:trainmonk25@35.223.144.85:5432/train-d...
2025-09-13 09:15:49,941 - db_utils - INFO - db_utils: Using standard PostgreSQL connection.
2025-09-13 09:15:50,657 - db_utils - INFO - db_utils: PostgreSQL connection successful!
2025-09-13 09:15:50,957 - db_utils - ERROR - db_utils: Database connection error: not all arguments converted during string formatting
Traceback (most recent call last):
  File "C:\Users\robho\Documents\TrainingMonkey-Clean\app\db_utils.py", line 97, in get_db_connection
    yield conn
  File "C:\Users\robho\Documents\TrainingMonkey-Clean\app\db_utils.py", line 130, in execute_query
    cursor.execute(query, params)
  File "C:\Users\robho\AppData\Roaming\Python\Python311\site-packages\psycopg2\extras.py", line 236, in execute
    return super().execute(query, vars)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: not all arguments converted during string formatting
2025-09-13 09:15:51,056 - db_utils - INFO - db_utils: Database connection closed.
2025-09-13 09:15:51,056 - db_utils - ERROR - db_utils: Query failed: not all arguments converted during string formatting
2025-09-13 09:15:51,056 - db_utils - ERROR - db_utils: Query was: INSERT INTO token_audit_log 
                   (user_id, operation, success, timestamp, ip_address, user_agent, details)
                   VALUES (%s)
2025-09-13 09:15:51,056 - db_utils - ERROR - db_utils: Params were: (1, 'load_tokens', True, '2025-09-13T09:15:49.941869', 'unknown', 'unknown', '{"operation": "token_load", "user_id": 1, "source": "enhanced_token_management"}')
2025-09-13 09:15:51,056 - secure_token_storage - ERROR - Error logging token operation: not all arguments converted during string formatting
2025-09-13 09:15:51,056 - secure_token_storage - INFO - Tokens securely loaded for user 1
2025-09-13 09:15:51,056 - enhanced_token_management - INFO - Tokens loaded securely for user 1
2025-09-13 09:15:51,056 - enhanced_token_management - INFO - Token still valid - expires in 4 hours
2025-09-13 09:15:51,056 - root - WARNING - Please make sure your STRAVA_CLIENT_ID is set in your environment.Add SILENCE_TOKEN_WARNINGS=true to your environment to disable this error.
2025-09-13 09:15:51,056 - root - WARNING - STRAVA_CLIENT_ID and STRAVA_CLIENT_SECRET not found in your  environment. Please refresh your access_token manually. Or add STRAVA_CLIENT_ID and STRAVA_CLIENT_SECRET to your environment.Add SILENCE_TOKEN_WARNINGS=true to your environment to silence this warning.
2025-09-13 09:15:51,056 - stravalib.protocol.ApiV3 - INFO - GET 'https://www.strava.com/api/v3/athlete' with params {}
2025-09-13 09:15:51,881 - enhanced_token_management - INFO - Successfully connected as Rob Houghton for user 1
2025-09-13 09:15:51,881 - stravalib.protocol.ApiV3 - INFO - GET 'https://www.strava.com/api/v3/activities/15778749663' with params {'include_all_efforts': False}
2025-09-13 09:15:52,340 - strava_training_load - INFO - Fetching streams for activity 15778749663
2025-09-13 09:15:52,340 - stravalib.protocol.ApiV3 - INFO - GET 'https://www.strava.com/api/v3/activities/15778749663/streams' with params {'keys': 'time,distance,heartrate,altitude,velocity_smooth,cadence,watts,temp,moving,grade_smooth', 'key_by_type': True}
2025-09-13 09:15:52,522 - stravalib.util.limiter.SleepingRateLimitRule - WARNING - No rates present in response headers
2025-09-13 09:15:52,522 - strava_training_load - INFO - Successfully fetched streams for activity 15778749663: ['altitude', 'watts', 'moving', 'cadence', 'velocity_smooth', 'time', 'heartrate', 'grade_smooth', 'distance']
2025-09-13 09:15:52,522 - strava_training_load - INFO - Heartrate stream data available: 4793 samples
2025-09-13 09:15:52,522 - db_utils - INFO - db_utils: Saving HR stream data for activity 15778749663, user 1
2025-09-13 09:15:52,522 - db_utils - INFO - db_utils: Attempting PostgreSQL connection within context manager.
2025-09-13 09:15:52,522 - db_utils - INFO - db_utils: DATABASE_URL: postgresql://appuser:trainmonk25@35.223.144.85:5432/train-d...
2025-09-13 09:15:52,522 - db_utils - INFO - db_utils: Using standard PostgreSQL connection.
2025-09-13 09:15:53,066 - db_utils - INFO - db_utils: PostgreSQL connection successful!
2025-09-13 09:15:53,459 - db_utils - INFO - db_utils: Database connection closed.
2025-09-13 09:15:53,459 - db_utils - INFO - db_utils: Successfully saved HR stream data for activity 15778749663 (4793 samples)
2025-09-13 09:15:53,459 - db_utils - INFO - db_utils: Retrieving HR stream data for activity 15778749663
2025-09-13 09:15:53,459 - db_utils - INFO - db_utils: Attempting PostgreSQL connection within context manager.
2025-09-13 09:15:53,459 - db_utils - INFO - db_utils: DATABASE_URL: postgresql://appuser:trainmonk25@35.223.144.85:5432/train-d...
2025-09-13 09:15:53,459 - db_utils - INFO - db_utils: Using standard PostgreSQL connection.
2025-09-13 09:15:53,988 - db_utils - INFO - db_utils: PostgreSQL connection successful!
2025-09-13 09:15:54,279 - db_utils - INFO - db_utils: Database connection closed.
2025-09-13 09:15:54,279 - db_utils - INFO - db_utils: Retrieved HR stream data for activity 15778749663 (4793 samples)
2025-09-13 09:15:54,279 - enhanced_token_management - INFO - Getting working Strava client for user 1...
2025-09-13 09:15:54,279 - db_utils - INFO - db_utils: Attempting PostgreSQL connection within context manager.
2025-09-13 09:15:54,279 - db_utils - INFO - db_utils: DATABASE_URL: postgresql://appuser:trainmonk25@35.223.144.85:5432/train-d...
2025-09-13 09:15:54,279 - db_utils - INFO - db_utils: Using standard PostgreSQL connection.
2025-09-13 09:15:54,754 - db_utils - INFO - db_utils: PostgreSQL connection successful!
2025-09-13 09:15:54,954 - db_utils - INFO - db_utils: Database connection closed.
2025-09-13 09:15:54,954 - secure_token_storage - INFO - Securely loading tokens for user 1
2025-09-13 09:15:54,954 - db_utils - INFO - db_utils: Attempting PostgreSQL connection within context manager.
2025-09-13 09:15:54,954 - db_utils - INFO - db_utils: DATABASE_URL: postgresql://appuser:trainmonk25@35.223.144.85:5432/train-d...
2025-09-13 09:15:54,954 - db_utils - INFO - db_utils: Using standard PostgreSQL connection.
2025-09-13 09:15:55,423 - db_utils - INFO - db_utils: PostgreSQL connection successful!
2025-09-13 09:15:55,601 - db_utils - INFO - db_utils: Database connection closed.
2025-09-13 09:15:55,601 - db_utils - INFO - db_utils: Attempting PostgreSQL connection within context manager.
2025-09-13 09:15:55,601 - db_utils - INFO - db_utils: DATABASE_URL: postgresql://appuser:trainmonk25@35.223.144.85:5432/train-d...
2025-09-13 09:15:55,601 - db_utils - INFO - db_utils: Using standard PostgreSQL connection.
2025-09-13 09:15:56,109 - db_utils - INFO - db_utils: PostgreSQL connection successful!
2025-09-13 09:15:56,481 - db_utils - ERROR - db_utils: Database connection error: not all arguments converted during string formatting
Traceback (most recent call last):
  File "C:\Users\robho\Documents\TrainingMonkey-Clean\app\db_utils.py", line 97, in get_db_connection
    yield conn
  File "C:\Users\robho\Documents\TrainingMonkey-Clean\app\db_utils.py", line 130, in execute_query
    cursor.execute(query, params)
  File "C:\Users\robho\AppData\Roaming\Python\Python311\site-packages\psycopg2\extras.py", line 236, in execute
    return super().execute(query, vars)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: not all arguments converted during string formatting
2025-09-13 09:15:56,590 - db_utils - INFO - db_utils: Database connection closed.
2025-09-13 09:15:56,590 - db_utils - ERROR - db_utils: Query failed: not all arguments converted during string formatting
2025-09-13 09:15:56,590 - db_utils - ERROR - db_utils: Query was: INSERT INTO token_audit_log 
                   (user_id, operation, success, timestamp, ip_address, user_agent, details)
                   VALUES (%s)
2025-09-13 09:15:56,590 - db_utils - ERROR - db_utils: Params were: (1, 'load_tokens', True, '2025-09-13T09:15:55.601536', 'unknown', 'unknown', '{"operation": "token_load", "user_id": 1, "source": "enhanced_token_management"}')
2025-09-13 09:15:56,590 - secure_token_storage - ERROR - Error logging token operation: not all arguments converted during string formatting
2025-09-13 09:15:56,590 - secure_token_storage - INFO - Tokens securely loaded for user 1
2025-09-13 09:15:56,590 - enhanced_token_management - INFO - Tokens loaded securely for user 1
2025-09-13 09:15:56,590 - enhanced_token_management - INFO - Token still valid - expires in 4 hours
2025-09-13 09:15:56,590 - root - WARNING - Please make sure your STRAVA_CLIENT_ID is set in your environment.Add SILENCE_TOKEN_WARNINGS=true to your environment to disable this error.
2025-09-13 09:15:56,590 - root - WARNING - STRAVA_CLIENT_ID and STRAVA_CLIENT_SECRET not found in your  environment. Please refresh your access_token manually. Or add STRAVA_CLIENT_ID and STRAVA_CLIENT_SECRET to your environment.Add SILENCE_TOKEN_WARNINGS=true to your environment to silence this warning.
2025-09-13 09:15:56,590 - stravalib.protocol.ApiV3 - INFO - GET 'https://www.strava.com/api/v3/athlete' with params {}
2025-09-13 09:15:57,215 - enhanced_token_management - INFO - Successfully connected as Rob Houghton for user 1
2025-09-13 09:15:57,216 - stravalib.protocol.ApiV3 - INFO - GET 'https://www.strava.com/api/v3/activities/15755985290' with params {'include_all_efforts': False}
2025-09-13 09:15:57,918 - strava_training_load - INFO - Fetching streams for activity 15755985290
2025-09-13 09:15:57,918 - stravalib.protocol.ApiV3 - INFO - GET 'https://www.strava.com/api/v3/activities/15755985290/streams' with params {'keys': 'time,distance,heartrate,altitude,velocity_smooth,cadence,watts,temp,moving,grade_smooth', 'key_by_type': True}
2025-09-13 09:15:58,441 - stravalib.util.limiter.SleepingRateLimitRule - WARNING - No rates present in response headers
2025-09-13 09:15:58,444 - strava_training_load - INFO - Successfully fetched streams for activity 15755985290: ['altitude', 'watts', 'moving', 'cadence', 'velocity_smooth', 'time', 'heartrate', 'grade_smooth', 'distance']
2025-09-13 09:15:58,444 - strava_training_load - INFO - Heartrate stream data available: 4286 samples
2025-09-13 09:15:58,444 - db_utils - INFO - db_utils: Saving HR stream data for activity 15755985290, user 1
2025-09-13 09:15:58,444 - db_utils - INFO - db_utils: Attempting PostgreSQL connection within context manager.
2025-09-13 09:15:58,444 - db_utils - INFO - db_utils: DATABASE_URL: postgresql://appuser:trainmonk25@35.223.144.85:5432/train-d...
2025-09-13 09:15:58,444 - db_utils - INFO - db_utils: Using standard PostgreSQL connection.
2025-09-13 09:15:59,260 - db_utils - INFO - db_utils: PostgreSQL connection successful!
2025-09-13 09:15:59,724 - db_utils - INFO - db_utils: Database connection closed.
2025-09-13 09:15:59,724 - db_utils - INFO - db_utils: Successfully saved HR stream data for activity 15755985290 (4286 samples)
2025-09-13 09:15:59,724 - db_utils - INFO - db_utils: Retrieving HR stream data for activity 15755985290
2025-09-13 09:15:59,724 - db_utils - INFO - db_utils: Attempting PostgreSQL connection within context manager.
2025-09-13 09:15:59,724 - db_utils - INFO - db_utils: DATABASE_URL: postgresql://appuser:trainmonk25@35.223.144.85:5432/train-d...
2025-09-13 09:15:59,724 - db_utils - INFO - db_utils: Using standard PostgreSQL connection.
2025-09-13 09:16:00,562 - db_utils - INFO - db_utils: PostgreSQL connection successful!
2025-09-13 09:16:00,834 - db_utils - INFO - db_utils: Database connection closed.
2025-09-13 09:16:00,834 - db_utils - INFO - db_utils: Retrieved HR stream data for activity 15755985290 (4286 samples)
2025-09-13 09:16:00,834 - enhanced_token_management - INFO - Getting working Strava client for user 1...
2025-09-13 09:16:00,834 - db_utils - INFO - db_utils: Attempting PostgreSQL connection within context manager.
2025-09-13 09:16:00,834 - db_utils - INFO - db_utils: DATABASE_URL: postgresql://appuser:trainmonk25@35.223.144.85:5432/train-d...
2025-09-13 09:16:00,834 - db_utils - INFO - db_utils: Using standard PostgreSQL connection.
2025-09-13 09:16:01,320 - db_utils - INFO - db_utils: PostgreSQL connection successful!
2025-09-13 09:16:01,537 - db_utils - INFO - db_utils: Database connection closed.
2025-09-13 09:16:01,537 - secure_token_storage - INFO - Securely loading tokens for user 1
2025-09-13 09:16:01,537 - db_utils - INFO - db_utils: Attempting PostgreSQL connection within context manager.
2025-09-13 09:16:01,537 - db_utils - INFO - db_utils: DATABASE_URL: postgresql://appuser:trainmonk25@35.223.144.85:5432/train-d...
2025-09-13 09:16:01,537 - db_utils - INFO - db_utils: Using standard PostgreSQL connection.
2025-09-13 09:16:02,098 - db_utils - INFO - db_utils: PostgreSQL connection successful!
2025-09-13 09:16:02,307 - db_utils - INFO - db_utils: Database connection closed.
2025-09-13 09:16:02,307 - db_utils - INFO - db_utils: Attempting PostgreSQL connection within context manager.
2025-09-13 09:16:02,307 - db_utils - INFO - db_utils: DATABASE_URL: postgresql://appuser:trainmonk25@35.223.144.85:5432/train-d...
2025-09-13 09:16:02,307 - db_utils - INFO - db_utils: Using standard PostgreSQL connection.
2025-09-13 09:16:02,836 - db_utils - INFO - db_utils: PostgreSQL connection successful!
2025-09-13 09:16:02,977 - db_utils - ERROR - db_utils: Database connection error: not all arguments converted during string formatting
Traceback (most recent call last):
  File "C:\Users\robho\Documents\TrainingMonkey-Clean\app\db_utils.py", line 97, in get_db_connection
    yield conn
  File "C:\Users\robho\Documents\TrainingMonkey-Clean\app\db_utils.py", line 130, in execute_query
    cursor.execute(query, params)
  File "C:\Users\robho\AppData\Roaming\Python\Python311\site-packages\psycopg2\extras.py", line 236, in execute
    return super().execute(query, vars)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: not all arguments converted during string formatting
2025-09-13 09:16:03,030 - db_utils - INFO - db_utils: Database connection closed.
2025-09-13 09:16:03,030 - db_utils - ERROR - db_utils: Query failed: not all arguments converted during string formatting
2025-09-13 09:16:03,030 - db_utils - ERROR - db_utils: Query was: INSERT INTO token_audit_log 
                   (user_id, operation, success, timestamp, ip_address, user_agent, details)
                   VALUES (%s)
2025-09-13 09:16:03,030 - db_utils - ERROR - db_utils: Params were: (1, 'load_tokens', True, '2025-09-13T09:16:02.307905', 'unknown', 'unknown', '{"operation": "token_load", "user_id": 1, "source": "enhanced_token_management"}')
2025-09-13 09:16:03,030 - secure_token_storage - ERROR - Error logging token operation: not all arguments converted during string formatting
2025-09-13 09:16:03,030 - secure_token_storage - INFO - Tokens securely loaded for user 1
2025-09-13 09:16:03,030 - enhanced_token_management - INFO - Tokens loaded securely for user 1
2025-09-13 09:16:03,030 - enhanced_token_management - INFO - Token still valid - expires in 4 hours
2025-09-13 09:16:03,046 - root - WARNING - Please make sure your STRAVA_CLIENT_ID is set in your environment.Add SILENCE_TOKEN_WARNINGS=true to your environment to disable this error.
2025-09-13 09:16:03,046 - root - WARNING - STRAVA_CLIENT_ID and STRAVA_CLIENT_SECRET not found in your  environment. Please refresh your access_token manually. Or add STRAVA_CLIENT_ID and STRAVA_CLIENT_SECRET to your environment.Add SILENCE_TOKEN_WARNINGS=true to your environment to silence this warning.
2025-09-13 09:16:03,046 - stravalib.protocol.ApiV3 - INFO - GET 'https://www.strava.com/api/v3/athlete' with params {}
2025-09-13 09:16:03,552 - enhanced_token_management - INFO - Successfully connected as Rob Houghton for user 1
2025-09-13 09:16:03,552 - stravalib.protocol.ApiV3 - INFO - GET 'https://www.strava.com/api/v3/activities/15767717105' with params {'include_all_efforts': False}
2025-09-13 09:16:03,970 - strava_training_load - INFO - Fetching streams for activity 15767717105
2025-09-13 09:16:03,970 - stravalib.protocol.ApiV3 - INFO - GET 'https://www.strava.com/api/v3/activities/15767717105/streams' with params {'keys': 'time,distance,heartrate,altitude,velocity_smooth,cadence,watts,temp,moving,grade_smooth', 'key_by_type': True}
2025-09-13 09:16:04,134 - stravalib.util.limiter.SleepingRateLimitRule - WARNING - No rates present in response headers
2025-09-13 09:16:04,134 - strava_training_load - INFO - Successfully fetched streams for activity 15767717105: ['altitude', 'watts', 'moving', 'cadence', 'velocity_smooth', 'time', 'heartrate', 'grade_smooth', 'distance']
2025-09-13 09:16:04,134 - strava_training_load - INFO - Heartrate stream data available: 2335 samples
2025-09-13 09:16:04,134 - db_utils - INFO - db_utils: Saving HR stream data for activity 15767717105, user 1
2025-09-13 09:16:04,134 - db_utils - INFO - db_utils: Attempting PostgreSQL connection within context manager.
2025-09-13 09:16:04,134 - db_utils - INFO - db_utils: DATABASE_URL: postgresql://appuser:trainmonk25@35.223.144.85:5432/train-d...
2025-09-13 09:16:04,134 - db_utils - INFO - db_utils: Using standard PostgreSQL connection.
2025-09-13 09:16:04,885 - db_utils - INFO - db_utils: PostgreSQL connection successful!
2025-09-13 09:16:05,296 - db_utils - INFO - db_utils: Database connection closed.
2025-09-13 09:16:05,296 - db_utils - INFO - db_utils: Successfully saved HR stream data for activity 15767717105 (2335 samples)
2025-09-13 09:16:05,296 - db_utils - INFO - db_utils: Retrieving HR stream data for activity 15767717105
2025-09-13 09:16:05,296 - db_utils - INFO - db_utils: Attempting PostgreSQL connection within context manager.
2025-09-13 09:16:05,296 - db_utils - INFO - db_utils: DATABASE_URL: postgresql://appuser:trainmonk25@35.223.144.85:5432/train-d...
2025-09-13 09:16:05,296 - db_utils - INFO - db_utils: Using standard PostgreSQL connection.
2025-09-13 09:16:06,011 - db_utils - INFO - db_utils: PostgreSQL connection successful!
2025-09-13 09:16:06,309 - db_utils - INFO - db_utils: Database connection closed.
2025-09-13 09:16:06,309 - db_utils - INFO - db_utils: Retrieved HR stream data for activity 15767717105 (2335 samples)
2025-09-13 09:16:06,310 - enhanced_token_management - INFO - Getting working Strava client for user 3...
2025-09-13 09:16:06,310 - db_utils - INFO - db_utils: Attempting PostgreSQL connection within context manager.
2025-09-13 09:16:06,310 - db_utils - INFO - db_utils: DATABASE_URL: postgresql://appuser:trainmonk25@35.223.144.85:5432/train-d...
2025-09-13 09:16:06,310 - db_utils - INFO - db_utils: Using standard PostgreSQL connection.
2025-09-13 09:16:06,832 - db_utils - INFO - db_utils: PostgreSQL connection successful!
2025-09-13 09:16:07,020 - db_utils - INFO - db_utils: Database connection closed.
2025-09-13 09:16:07,020 - secure_token_storage - INFO - Securely loading tokens for user 3
2025-09-13 09:16:07,020 - db_utils - INFO - db_utils: Attempting PostgreSQL connection within context manager.
2025-09-13 09:16:07,020 - db_utils - INFO - db_utils: DATABASE_URL: postgresql://appuser:trainmonk25@35.223.144.85:5432/train-d...
2025-09-13 09:16:07,020 - db_utils - INFO - db_utils: Using standard PostgreSQL connection.
2025-09-13 09:16:07,548 - db_utils - INFO - db_utils: PostgreSQL connection successful!
2025-09-13 09:16:07,755 - db_utils - INFO - db_utils: Database connection closed.
2025-09-13 09:16:07,755 - db_utils - INFO - db_utils: Attempting PostgreSQL connection within context manager.
2025-09-13 09:16:07,755 - db_utils - INFO - db_utils: DATABASE_URL: postgresql://appuser:trainmonk25@35.223.144.85:5432/train-d...
2025-09-13 09:16:07,755 - db_utils - INFO - db_utils: Using standard PostgreSQL connection.
2025-09-13 09:16:08,245 - db_utils - INFO - db_utils: PostgreSQL connection successful!
2025-09-13 09:16:08,476 - db_utils - ERROR - db_utils: Database connection error: not all arguments converted during string formatting
Traceback (most recent call last):
  File "C:\Users\robho\Documents\TrainingMonkey-Clean\app\db_utils.py", line 97, in get_db_connection
    yield conn
  File "C:\Users\robho\Documents\TrainingMonkey-Clean\app\db_utils.py", line 130, in execute_query
    cursor.execute(query, params)
  File "C:\Users\robho\AppData\Roaming\Python\Python311\site-packages\psycopg2\extras.py", line 236, in execute
    return super().execute(query, vars)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: not all arguments converted during string formatting
2025-09-13 09:16:08,577 - db_utils - INFO - db_utils: Database connection closed.
2025-09-13 09:16:08,577 - db_utils - ERROR - db_utils: Query failed: not all arguments converted during string formatting
2025-09-13 09:16:08,577 - db_utils - ERROR - db_utils: Query was: INSERT INTO token_audit_log 
                   (user_id, operation, success, timestamp, ip_address, user_agent, details)
                   VALUES (%s)
2025-09-13 09:16:08,577 - db_utils - ERROR - db_utils: Params were: (3, 'load_tokens', True, '2025-09-13T09:16:07.755320', 'unknown', 'unknown', '{"operation": "token_load", "user_id": 3, "source": "enhanced_token_management"}')
2025-09-13 09:16:08,577 - secure_token_storage - ERROR - Error logging token operation: not all arguments converted during string formatting
2025-09-13 09:16:08,577 - secure_token_storage - INFO - Tokens securely loaded for user 3
2025-09-13 09:16:08,577 - enhanced_token_management - INFO - Tokens loaded securely for user 3
2025-09-13 09:16:08,577 - enhanced_token_management - INFO - Token needs refresh - expires in -3436 minutes
2025-09-13 09:16:08,577 - enhanced_token_management - INFO - Token needs refresh for user 3 - refreshing now...
2025-09-13 09:16:08,577 - enhanced_token_management - INFO - Starting enhanced token refresh for user 3...
2025-09-13 09:16:08,578 - db_utils - INFO - db_utils: Attempting PostgreSQL connection within context manager.
2025-09-13 09:16:08,578 - db_utils - INFO - db_utils: DATABASE_URL: postgresql://appuser:trainmonk25@35.223.144.85:5432/train-d...
2025-09-13 09:16:08,578 - db_utils - INFO - db_utils: Using standard PostgreSQL connection.
2025-09-13 09:16:09,289 - db_utils - INFO - db_utils: PostgreSQL connection successful!
2025-09-13 09:16:09,601 - db_utils - INFO - db_utils: Database connection closed.
2025-09-13 09:16:09,601 - secure_token_storage - INFO - Securely loading tokens for user 3
2025-09-13 09:16:09,601 - db_utils - INFO - db_utils: Attempting PostgreSQL connection within context manager.
2025-09-13 09:16:09,602 - db_utils - INFO - db_utils: DATABASE_URL: postgresql://appuser:trainmonk25@35.223.144.85:5432/train-d...
2025-09-13 09:16:09,602 - db_utils - INFO - db_utils: Using standard PostgreSQL connection.
2025-09-13 09:16:10,300 - db_utils - INFO - db_utils: PostgreSQL connection successful!
2025-09-13 09:16:10,624 - db_utils - INFO - db_utils: Database connection closed.
2025-09-13 09:16:10,624 - db_utils - INFO - db_utils: Attempting PostgreSQL connection within context manager.
2025-09-13 09:16:10,624 - db_utils - INFO - db_utils: DATABASE_URL: postgresql://appuser:trainmonk25@35.223.144.85:5432/train-d...
2025-09-13 09:16:10,624 - db_utils - INFO - db_utils: Using standard PostgreSQL connection.
2025-09-13 09:16:11,442 - db_utils - INFO - db_utils: PostgreSQL connection successful!
2025-09-13 09:16:11,648 - db_utils - ERROR - db_utils: Database connection error: not all arguments converted during string formatting
Traceback (most recent call last):
  File "C:\Users\robho\Documents\TrainingMonkey-Clean\app\db_utils.py", line 97, in get_db_connection
    yield conn
  File "C:\Users\robho\Documents\TrainingMonkey-Clean\app\db_utils.py", line 130, in execute_query
    cursor.execute(query, params)
  File "C:\Users\robho\AppData\Roaming\Python\Python311\site-packages\psycopg2\extras.py", line 236, in execute
    return super().execute(query, vars)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: not all arguments converted during string formatting
2025-09-13 09:16:11,739 - db_utils - INFO - db_utils: Database connection closed.
2025-09-13 09:16:11,739 - db_utils - ERROR - db_utils: Query failed: not all arguments converted during string formatting
2025-09-13 09:16:11,739 - db_utils - ERROR - db_utils: Query was: INSERT INTO token_audit_log 
                   (user_id, operation, success, timestamp, ip_address, user_agent, details)
                   VALUES (%s)
2025-09-13 09:16:11,739 - db_utils - ERROR - db_utils: Params were: (3, 'load_tokens', True, '2025-09-13T09:16:10.624117', 'unknown', 'unknown', '{"operation": "token_load", "user_id": 3, "source": "enhanced_token_management"}')
2025-09-13 09:16:11,739 - secure_token_storage - ERROR - Error logging token operation: not all arguments converted during string formatting
2025-09-13 09:16:11,739 - secure_token_storage - INFO - Tokens securely loaded for user 3
2025-09-13 09:16:11,739 - enhanced_token_management - INFO - Tokens loaded securely for user 3
2025-09-13 09:16:11,739 - enhanced_token_management - INFO - Using centralized Strava credentials for user 3
2025-09-13 09:16:11,739 - enhanced_token_management - INFO - Token refresh attempt 1/3 for user 3
2025-09-13 09:16:11,739 - root - WARNING - Please make sure your STRAVA_CLIENT_ID is set in your environment.Add SILENCE_TOKEN_WARNINGS=true to your environment to disable this error.
2025-09-13 09:16:11,739 - root - WARNING - STRAVA_CLIENT_ID and STRAVA_CLIENT_SECRET not found in your  environment. Please refresh your access_token manually. Or add STRAVA_CLIENT_ID and STRAVA_CLIENT_SECRET to your environment.Add SILENCE_TOKEN_WARNINGS=true to your environment to silence this warning.
2025-09-13 09:16:11,739 - enhanced_token_management - INFO - Attempting token refresh with client_id: 47238...
2025-09-13 09:16:11,739 - stravalib.protocol.ApiV3 - INFO - POST 'https://www.strava.com/oauth/token' with params {'client_id': '47238', 'client_secret': '65cb63b7b469b09d96ce72124fa7af7af4bf80e3', 'refresh_token': '248f05896ce784a20695aa69871e6cb2ea81cd08', 'grant_type': 'refresh_token'}
2025-09-13 09:16:12,308 - stravalib.util.limiter.SleepingRateLimitRule - WARNING - No rates present in response headers
2025-09-13 09:16:12,308 - enhanced_token_management - INFO - Strava API refresh successful
2025-09-13 09:16:12,324 - enhanced_token_management - INFO - Saving tokens to database for user 3
2025-09-13 09:16:12,324 - db_utils - INFO - db_utils: Attempting PostgreSQL connection within context manager.
2025-09-13 09:16:12,324 - db_utils - INFO - db_utils: DATABASE_URL: postgresql://appuser:trainmonk25@35.223.144.85:5432/train-d...
2025-09-13 09:16:12,324 - db_utils - INFO - db_utils: Using standard PostgreSQL connection.
2025-09-13 09:16:13,284 - db_utils - INFO - db_utils: PostgreSQL connection successful!
2025-09-13 09:16:13,805 - db_utils - INFO - db_utils: Database connection closed.
2025-09-13 09:16:13,805 - secure_token_storage - INFO - Securely saving tokens for user 3
2025-09-13 09:16:13,807 - db_utils - INFO - db_utils: Attempting PostgreSQL connection within context manager.
2025-09-13 09:16:13,807 - db_utils - INFO - db_utils: DATABASE_URL: postgresql://appuser:trainmonk25@35.223.144.85:5432/train-d...
2025-09-13 09:16:13,807 - db_utils - INFO - db_utils: Using standard PostgreSQL connection.
2025-09-13 09:16:14,512 - db_utils - INFO - db_utils: PostgreSQL connection successful!
2025-09-13 09:16:14,916 - db_utils - INFO - db_utils: Database connection closed.
2025-09-13 09:16:14,916 - db_utils - INFO - db_utils: Attempting PostgreSQL connection within context manager.
2025-09-13 09:16:14,916 - db_utils - INFO - db_utils: DATABASE_URL: postgresql://appuser:trainmonk25@35.223.144.85:5432/train-d...
2025-09-13 09:16:14,916 - db_utils - INFO - db_utils: Using standard PostgreSQL connection.
2025-09-13 09:16:15,518 - db_utils - INFO - db_utils: PostgreSQL connection successful!
2025-09-13 09:16:15,713 - db_utils - ERROR - db_utils: Database connection error: not all arguments converted during string formatting
Traceback (most recent call last):
  File "C:\Users\robho\Documents\TrainingMonkey-Clean\app\db_utils.py", line 97, in get_db_connection
    yield conn
  File "C:\Users\robho\Documents\TrainingMonkey-Clean\app\db_utils.py", line 130, in execute_query
    cursor.execute(query, params)
  File "C:\Users\robho\AppData\Roaming\Python\Python311\site-packages\psycopg2\extras.py", line 236, in execute
    return super().execute(query, vars)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: not all arguments converted during string formatting
2025-09-13 09:16:15,783 - db_utils - INFO - db_utils: Database connection closed.
2025-09-13 09:16:15,783 - db_utils - ERROR - db_utils: Query failed: not all arguments converted during string formatting
2025-09-13 09:16:15,783 - db_utils - ERROR - db_utils: Query was: INSERT INTO token_audit_log 
                   (user_id, operation, success, timestamp, ip_address, user_agent, details)
                   VALUES (%s)
2025-09-13 09:16:15,783 - db_utils - ERROR - db_utils: Params were: (3, 'save_tokens', True, '2025-09-13T09:16:14.916214', 'unknown', 'unknown', '{"operation": "oauth_callback", "user_id": 3, "athlete_id": 18762311, "source": "enhanced_token_management"}')
2025-09-13 09:16:15,783 - secure_token_storage - ERROR - Error logging token operation: not all arguments converted during string formatting
2025-09-13 09:16:15,783 - secure_token_storage - INFO - Tokens securely saved for user 3
2025-09-13 09:16:15,783 - enhanced_token_management - INFO - Tokens saved securely for user 3
2025-09-13 09:16:15,783 - enhanced_token_management - INFO - Token refresh completed successfully for user 3 on attempt 1
2025-09-13 09:16:15,783 - root - WARNING - Please make sure your STRAVA_CLIENT_ID is set in your environment.Add SILENCE_TOKEN_WARNINGS=true to your environment to disable this error.
2025-09-13 09:16:15,783 - root - WARNING - STRAVA_CLIENT_ID and STRAVA_CLIENT_SECRET not found in your  environment. Please refresh your access_token manually. Or add STRAVA_CLIENT_ID and STRAVA_CLIENT_SECRET to your environment.Add SILENCE_TOKEN_WARNINGS=true to your environment to silence this warning.
2025-09-13 09:16:15,783 - stravalib.protocol.ApiV3 - INFO - GET 'https://www.strava.com/api/v3/athlete' with params {}
2025-09-13 09:16:16,365 - enhanced_token_management - INFO - Successfully connected as Isabel Houghton for user 3
2025-09-13 09:16:16,366 - stravalib.protocol.ApiV3 - INFO - GET 'https://www.strava.com/api/v3/activities/15741707797' with params {'include_all_efforts': False}
2025-09-13 09:16:17,001 - strava_training_load - INFO - Fetching streams for activity 15741707797
2025-09-13 09:16:17,002 - stravalib.protocol.ApiV3 - INFO - GET 'https://www.strava.com/api/v3/activities/15741707797/streams' with params {'keys': 'time,distance,heartrate,altitude,velocity_smooth,cadence,watts,temp,moving,grade_smooth', 'key_by_type': True}
2025-09-13 09:16:17,143 - stravalib.util.limiter.SleepingRateLimitRule - WARNING - No rates present in response headers
2025-09-13 09:16:17,144 - strava_training_load - INFO - Successfully fetched streams for activity 15741707797: ['altitude', 'moving', 'cadence', 'velocity_smooth', 'time', 'heartrate', 'grade_smooth', 'distance']
2025-09-13 09:16:17,144 - strava_training_load - INFO - Heartrate stream data available: 1126 samples
2025-09-13 09:16:17,145 - db_utils - INFO - db_utils: Saving HR stream data for activity 15741707797, user 3
2025-09-13 09:16:17,145 - db_utils - INFO - db_utils: Attempting PostgreSQL connection within context manager.
2025-09-13 09:16:17,145 - db_utils - INFO - db_utils: DATABASE_URL: postgresql://appuser:trainmonk25@35.223.144.85:5432/train-d...
2025-09-13 09:16:17,146 - db_utils - INFO - db_utils: Using standard PostgreSQL connection.
2025-09-13 09:16:17,671 - db_utils - INFO - db_utils: PostgreSQL connection successful!
2025-09-13 09:16:17,979 - db_utils - INFO - db_utils: Database connection closed.
2025-09-13 09:16:17,979 - db_utils - INFO - db_utils: Successfully saved HR stream data for activity 15741707797 (1126 samples)
2025-09-13 09:16:17,979 - db_utils - INFO - db_utils: Retrieving HR stream data for activity 15741707797
2025-09-13 09:16:17,979 - db_utils - INFO - db_utils: Attempting PostgreSQL connection within context manager.
2025-09-13 09:16:17,979 - db_utils - INFO - db_utils: DATABASE_URL: postgresql://appuser:trainmonk25@35.223.144.85:5432/train-d...
2025-09-13 09:16:17,980 - db_utils - INFO - db_utils: Using standard PostgreSQL connection.
2025-09-13 09:16:18,510 - db_utils - INFO - db_utils: PostgreSQL connection successful!
2025-09-13 09:16:18,700 - db_utils - INFO - db_utils: Database connection closed.
2025-09-13 09:16:18,700 - db_utils - INFO - db_utils: Retrieved HR stream data for activity 15741707797 (1126 samples)
2025-09-13 09:16:18,700 - enhanced_token_management - INFO - Getting working Strava client for user 3...
2025-09-13 09:16:18,700 - db_utils - INFO - db_utils: Attempting PostgreSQL connection within context manager.
2025-09-13 09:16:18,700 - db_utils - INFO - db_utils: DATABASE_URL: postgresql://appuser:trainmonk25@35.223.144.85:5432/train-d...
2025-09-13 09:16:18,701 - db_utils - INFO - db_utils: Using standard PostgreSQL connection.
2025-09-13 09:16:19,231 - db_utils - INFO - db_utils: PostgreSQL connection successful!
2025-09-13 09:16:19,431 - db_utils - INFO - db_utils: Database connection closed.
2025-09-13 09:16:19,431 - secure_token_storage - INFO - Securely loading tokens for user 3
2025-09-13 09:16:19,431 - db_utils - INFO - db_utils: Attempting PostgreSQL connection within context manager.
2025-09-13 09:16:19,431 - db_utils - INFO - db_utils: DATABASE_URL: postgresql://appuser:trainmonk25@35.223.144.85:5432/train-d...
2025-09-13 09:16:19,431 - db_utils - INFO - db_utils: Using standard PostgreSQL connection.
2025-09-13 09:16:19,955 - db_utils - INFO - db_utils: PostgreSQL connection successful!
2025-09-13 09:16:20,182 - db_utils - INFO - db_utils: Database connection closed.
2025-09-13 09:16:20,183 - db_utils - INFO - db_utils: Attempting PostgreSQL connection within context manager.
2025-09-13 09:16:20,183 - db_utils - INFO - db_utils: DATABASE_URL: postgresql://appuser:trainmonk25@35.223.144.85:5432/train-d...
2025-09-13 09:16:20,183 - db_utils - INFO - db_utils: Using standard PostgreSQL connection.
2025-09-13 09:16:20,693 - db_utils - INFO - db_utils: PostgreSQL connection successful!
2025-09-13 09:16:20,830 - db_utils - ERROR - db_utils: Database connection error: not all arguments converted during string formatting
Traceback (most recent call last):
  File "C:\Users\robho\Documents\TrainingMonkey-Clean\app\db_utils.py", line 97, in get_db_connection
    yield conn
  File "C:\Users\robho\Documents\TrainingMonkey-Clean\app\db_utils.py", line 130, in execute_query
    cursor.execute(query, params)
  File "C:\Users\robho\AppData\Roaming\Python\Python311\site-packages\psycopg2\extras.py", line 236, in execute
    return super().execute(query, vars)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: not all arguments converted during string formatting
2025-09-13 09:16:20,902 - db_utils - INFO - db_utils: Database connection closed.
2025-09-13 09:16:20,902 - db_utils - ERROR - db_utils: Query failed: not all arguments converted during string formatting
2025-09-13 09:16:20,902 - db_utils - ERROR - db_utils: Query was: INSERT INTO token_audit_log 
                   (user_id, operation, success, timestamp, ip_address, user_agent, details)
                   VALUES (%s)
2025-09-13 09:16:20,902 - db_utils - ERROR - db_utils: Params were: (3, 'load_tokens', True, '2025-09-13T09:16:20.182402', 'unknown', 'unknown', '{"operation": "token_load", "user_id": 3, "source": "enhanced_token_management"}')
2025-09-13 09:16:20,902 - secure_token_storage - ERROR - Error logging token operation: not all arguments converted during string formatting
2025-09-13 09:16:20,902 - secure_token_storage - INFO - Tokens securely loaded for user 3
2025-09-13 09:16:20,902 - enhanced_token_management - INFO - Tokens loaded securely for user 3
2025-09-13 09:16:20,902 - enhanced_token_management - INFO - Token still valid - expires in 5 hours
2025-09-13 09:16:20,902 - root - WARNING - Please make sure your STRAVA_CLIENT_ID is set in your environment.Add SILENCE_TOKEN_WARNINGS=true to your environment to disable this error.
2025-09-13 09:16:20,902 - root - WARNING - STRAVA_CLIENT_ID and STRAVA_CLIENT_SECRET not found in your  environment. Please refresh your access_token manually. Or add STRAVA_CLIENT_ID and STRAVA_CLIENT_SECRET to your environment.Add SILENCE_TOKEN_WARNINGS=true to your environment to silence this warning.
2025-09-13 09:16:20,902 - stravalib.protocol.ApiV3 - INFO - GET 'https://www.strava.com/api/v3/athlete' with params {}
2025-09-13 09:16:21,435 - enhanced_token_management - INFO - Successfully connected as Isabel Houghton for user 3
2025-09-13 09:16:21,435 - stravalib.protocol.ApiV3 - INFO - GET 'https://www.strava.com/api/v3/activities/15741700209' with params {'include_all_efforts': False}
2025-09-13 09:16:22,034 - strava_training_load - INFO - Fetching streams for activity 15741700209
2025-09-13 09:16:22,034 - stravalib.protocol.ApiV3 - INFO - GET 'https://www.strava.com/api/v3/activities/15741700209/streams' with params {'keys': 'time,distance,heartrate,altitude,velocity_smooth,cadence,watts,temp,moving,grade_smooth', 'key_by_type': True}
2025-09-13 09:16:22,193 - stravalib.util.limiter.SleepingRateLimitRule - WARNING - No rates present in response headers
2025-09-13 09:16:22,194 - strava_training_load - INFO - Successfully fetched streams for activity 15741700209: ['altitude', 'moving', 'cadence', 'velocity_smooth', 'time', 'heartrate', 'grade_smooth', 'distance']
2025-09-13 09:16:22,194 - strava_training_load - INFO - Heartrate stream data available: 712 samples
2025-09-13 09:16:22,194 - db_utils - INFO - db_utils: Saving HR stream data for activity 15741700209, user 3
2025-09-13 09:16:22,194 - db_utils - INFO - db_utils: Attempting PostgreSQL connection within context manager.
2025-09-13 09:16:22,194 - db_utils - INFO - db_utils: DATABASE_URL: postgresql://appuser:trainmonk25@35.223.144.85:5432/train-d...
2025-09-13 09:16:22,194 - db_utils - INFO - db_utils: Using standard PostgreSQL connection.
2025-09-13 09:16:22,742 - db_utils - INFO - db_utils: PostgreSQL connection successful!
2025-09-13 09:16:23,050 - db_utils - INFO - db_utils: Database connection closed.
2025-09-13 09:16:23,051 - db_utils - INFO - db_utils: Successfully saved HR stream data for activity 15741700209 (712 samples)
2025-09-13 09:16:23,051 - db_utils - INFO - db_utils: Retrieving HR stream data for activity 15741700209
2025-09-13 09:16:23,051 - db_utils - INFO - db_utils: Attempting PostgreSQL connection within context manager.
2025-09-13 09:16:23,051 - db_utils - INFO - db_utils: DATABASE_URL: postgresql://appuser:trainmonk25@35.223.144.85:5432/train-d...
2025-09-13 09:16:23,051 - db_utils - INFO - db_utils: Using standard PostgreSQL connection.
2025-09-13 09:16:23,534 - db_utils - INFO - db_utils: PostgreSQL connection successful!
2025-09-13 09:16:23,731 - db_utils - INFO - db_utils: Database connection closed.
2025-09-13 09:16:23,731 - db_utils - INFO - db_utils: Retrieved HR stream data for activity 15741700209 (712 samples)
2025-09-13 09:16:23,732 - db_utils - INFO - db_utils: Database connection closed.
2025-09-13 09:30:55,396 - db_utils - INFO - db_utils: Attempting PostgreSQL connection within context manager.
2025-09-13 09:30:55,396 - db_utils - INFO - db_utils: DATABASE_URL: postgresql://appuser:trainmonk25@35.223.144.85:5432/train-d...
2025-09-13 09:30:55,396 - db_utils - INFO - db_utils: Using standard PostgreSQL connection.
2025-09-13 09:30:55,961 - db_utils - INFO - db_utils: PostgreSQL connection successful!
2025-09-13 09:30:55,961 - db_utils - INFO - db_utils: Attempting PostgreSQL connection within context manager.
2025-09-13 09:30:55,961 - db_utils - INFO - db_utils: DATABASE_URL: postgresql://appuser:trainmonk25@35.223.144.85:5432/train-d...
2025-09-13 09:30:55,961 - db_utils - INFO - db_utils: Using standard PostgreSQL connection.
2025-09-13 09:30:56,713 - db_utils - INFO - db_utils: PostgreSQL connection successful!
2025-09-13 09:30:56,980 - db_utils - INFO - db_utils: Database connection closed.
2025-09-13 09:30:56,980 - db_utils - INFO - db_utils: Attempting PostgreSQL connection within context manager.
2025-09-13 09:30:56,980 - db_utils - INFO - db_utils: DATABASE_URL: postgresql://appuser:trainmonk25@35.223.144.85:5432/train-d...
2025-09-13 09:30:56,980 - db_utils - INFO - db_utils: Using standard PostgreSQL connection.
2025-09-13 09:30:57,897 - db_utils - INFO - db_utils: PostgreSQL connection successful!
2025-09-13 09:30:58,148 - db_utils - INFO - db_utils: Database connection closed.
2025-09-13 09:30:58,148 - db_utils - INFO - db_utils: Attempting PostgreSQL connection within context manager.
2025-09-13 09:30:58,148 - db_utils - INFO - db_utils: DATABASE_URL: postgresql://appuser:trainmonk25@35.223.144.85:5432/train-d...
2025-09-13 09:30:58,148 - db_utils - INFO - db_utils: Using standard PostgreSQL connection.
2025-09-13 09:30:58,615 - db_utils - INFO - db_utils: PostgreSQL connection successful!
2025-09-13 09:30:59,059 - db_utils - INFO - db_utils: Database connection closed.
2025-09-13 09:30:59,059 - strava_training_load - INFO - TRIMP_CALC: Using heart rate stream data (stream_length=4793, duration=79.87min)
2025-09-13 09:30:59,059 - strava_training_load - INFO - TRIMP_CALC: Stream validation passed (valid_samples=4793, total_samples=4793)
2025-09-13 09:30:59,059 - strava_training_load - INFO - TRIMP_CALC: Duration distribution: 79.87 minutes across 4793 samples = 0.0167 minutes per sample
2025-09-13 09:30:59,059 - strava_training_load - INFO - TRIMP_CALC: Sample 0: HR=48, HRR=0.030, TRIMP=0.0003
2025-09-13 09:30:59,059 - strava_training_load - INFO - TRIMP_CALC: Sample 1: HR=47, HRR=0.022, TRIMP=0.0002
2025-09-13 09:30:59,059 - strava_training_load - INFO - TRIMP_CALC: Sample 2: HR=47, HRR=0.022, TRIMP=0.0002
2025-09-13 09:30:59,064 - strava_training_load - INFO - TRIMP_CALC: Duration distribution: 4793 valid samples, no skipped samples
2025-09-13 09:30:59,064 - strava_training_load - INFO - TRIMP_CALC: Stream calculation successful: 70.1 (samples=4793, duration=79.87, duration_per_sample=0.0167)
2025-09-13 09:30:59,064 - strava_training_load - INFO - TRIMP_CALC: Stream calculation completed, result=70.1
2025-09-13 09:30:59,064 - strava_training_load - INFO - TRIMP_CALC: Using average heart rate calculation (avg_hr=107.0, duration=79.87min)
2025-09-13 09:30:59,064 - strava_training_load - INFO - TRIMP_CALC: Average calculation successful: 59.27 (duration=79.87, avg_hr=107.0, HRR=0.47)
2025-09-13 09:30:59,064 - strava_training_load - INFO - TRIMP_CALC: Average calculation completed, result=59.27
2025-09-13 09:30:59,064 - strava_training_load - INFO - TRIMP_CALC: Using heart rate stream data (stream_length=2335, duration=38.9min)
2025-09-13 09:30:59,065 - strava_training_load - INFO - TRIMP_CALC: Stream validation passed (valid_samples=2335, total_samples=2335)
2025-09-13 09:30:59,065 - strava_training_load - INFO - TRIMP_CALC: Duration distribution: 38.9 minutes across 2335 samples = 0.0167 minutes per sample
2025-09-13 09:30:59,065 - strava_training_load - INFO - TRIMP_CALC: Sample 0: HR=81, HRR=0.276, TRIMP=0.0050
2025-09-13 09:30:59,065 - strava_training_load - INFO - TRIMP_CALC: Sample 1: HR=81, HRR=0.276, TRIMP=0.0050
2025-09-13 09:30:59,065 - strava_training_load - INFO - TRIMP_CALC: Sample 2: HR=81, HRR=0.276, TRIMP=0.0050
2025-09-13 09:30:59,067 - strava_training_load - INFO - TRIMP_CALC: Duration distribution: 2335 valid samples, no skipped samples
2025-09-13 09:30:59,067 - strava_training_load - INFO - TRIMP_CALC: Stream calculation successful: 33.43 (samples=2335, duration=38.9, duration_per_sample=0.0167)
2025-09-13 09:30:59,067 - strava_training_load - INFO - TRIMP_CALC: Stream calculation completed, result=33.43
2025-09-13 09:30:59,067 - strava_training_load - INFO - TRIMP_CALC: Using average heart rate calculation (avg_hr=108.4, duration=38.9min)
2025-09-13 09:30:59,067 - strava_training_load - INFO - TRIMP_CALC: Average calculation successful: 30.11 (duration=38.9, avg_hr=108.4, HRR=0.48)
2025-09-13 09:30:59,067 - strava_training_load - INFO - TRIMP_CALC: Average calculation completed, result=30.11
2025-09-13 09:30:59,068 - strava_training_load - INFO - TRIMP_CALC: Using heart rate stream data (stream_length=4286, duration=69.92min)
2025-09-13 09:30:59,068 - strava_training_load - INFO - TRIMP_CALC: Stream validation passed (valid_samples=4286, total_samples=4286)
2025-09-13 09:30:59,068 - strava_training_load - INFO - TRIMP_CALC: Duration distribution: 69.92 minutes across 4286 samples = 0.0163 minutes per sample
2025-09-13 09:30:59,068 - strava_training_load - INFO - TRIMP_CALC: Sample 0: HR=81, HRR=0.276, TRIMP=0.0049
2025-09-13 09:30:59,068 - strava_training_load - INFO - TRIMP_CALC: Sample 1: HR=82, HRR=0.284, TRIMP=0.0051
2025-09-13 09:30:59,068 - strava_training_load - INFO - TRIMP_CALC: Sample 2: HR=81, HRR=0.276, TRIMP=0.0049
2025-09-13 09:30:59,071 - strava_training_load - INFO - TRIMP_CALC: Duration distribution: 4286 valid samples, no skipped samples
2025-09-13 09:30:59,071 - strava_training_load - INFO - TRIMP_CALC: Stream calculation successful: 73.62 (samples=4286, duration=69.92, duration_per_sample=0.0163)
2025-09-13 09:30:59,071 - strava_training_load - INFO - TRIMP_CALC: Stream calculation completed, result=73.62
2025-09-13 09:30:59,071 - strava_training_load - INFO - TRIMP_CALC: Using average heart rate calculation (avg_hr=118.1, duration=69.92min)
2025-09-13 09:30:59,071 - strava_training_load - INFO - TRIMP_CALC: Average calculation successful: 71.55 (duration=69.92, avg_hr=118.1, HRR=0.55)
2025-09-13 09:30:59,071 - strava_training_load - INFO - TRIMP_CALC: Average calculation completed, result=71.55
2025-09-13 09:30:59,071 - strava_training_load - INFO - TRIMP_CALC: Using heart rate stream data (stream_length=5218, duration=84.83min)
2025-09-13 09:30:59,071 - strava_training_load - INFO - TRIMP_CALC: Stream validation passed (valid_samples=5218, total_samples=5218)
2025-09-13 09:30:59,071 - strava_training_load - INFO - TRIMP_CALC: Duration distribution: 84.83 minutes across 5218 samples = 0.0163 minutes per sample
2025-09-13 09:30:59,071 - strava_training_load - INFO - TRIMP_CALC: Sample 0: HR=91, HRR=0.351, TRIMP=0.0072
2025-09-13 09:30:59,071 - strava_training_load - INFO - TRIMP_CALC: Sample 1: HR=91, HRR=0.351, TRIMP=0.0072
2025-09-13 09:30:59,071 - strava_training_load - INFO - TRIMP_CALC: Sample 2: HR=92, HRR=0.358, TRIMP=0.0074
2025-09-13 09:30:59,075 - strava_training_load - INFO - TRIMP_CALC: Duration distribution: 5218 valid samples, no skipped samples
2025-09-13 09:30:59,075 - strava_training_load - INFO - TRIMP_CALC: Stream calculation successful: 143.58 (samples=5218, duration=84.83, duration_per_sample=0.0163)
2025-09-13 09:30:59,075 - strava_training_load - INFO - TRIMP_CALC: Stream calculation completed, result=143.58
2025-09-13 09:30:59,075 - strava_training_load - INFO - TRIMP_CALC: Using average heart rate calculation (avg_hr=136.5, duration=84.83min)
2025-09-13 09:30:59,075 - strava_training_load - INFO - TRIMP_CALC: Average calculation successful: 141.05 (duration=84.83, avg_hr=136.5, HRR=0.69)
2025-09-13 09:30:59,075 - strava_training_load - INFO - TRIMP_CALC: Average calculation completed, result=141.05
2025-09-13 09:30:59,076 - strava_training_load - INFO - TRIMP_CALC: Using heart rate stream data (stream_length=4089, duration=68.13min)
2025-09-13 09:30:59,076 - strava_training_load - INFO - TRIMP_CALC: Stream validation passed (valid_samples=4089, total_samples=4089)
2025-09-13 09:30:59,076 - strava_training_load - INFO - TRIMP_CALC: Duration distribution: 68.13 minutes across 4089 samples = 0.0167 minutes per sample
2025-09-13 09:30:59,076 - strava_training_load - INFO - TRIMP_CALC: Sample 0: HR=60, HRR=0.119, TRIMP=0.0016
2025-09-13 09:30:59,076 - strava_training_load - INFO - TRIMP_CALC: Sample 1: HR=60, HRR=0.119, TRIMP=0.0016
2025-09-13 09:30:59,076 - strava_training_load - INFO - TRIMP_CALC: Sample 2: HR=60, HRR=0.119, TRIMP=0.0016
2025-09-13 09:30:59,077 - strava_training_load - INFO - TRIMP_CALC: Duration distribution: 4089 valid samples, no skipped samples
2025-09-13 09:30:59,077 - strava_training_load - INFO - TRIMP_CALC: Stream calculation successful: 80.47 (samples=4089, duration=68.13, duration_per_sample=0.0167)
2025-09-13 09:30:59,077 - strava_training_load - INFO - TRIMP_CALC: Stream calculation completed, result=80.47
2025-09-13 09:30:59,077 - strava_training_load - INFO - TRIMP_CALC: Using average heart rate calculation (avg_hr=119.9, duration=68.13min)
2025-09-13 09:30:59,077 - strava_training_load - INFO - TRIMP_CALC: Average calculation successful: 73.28 (duration=68.13, avg_hr=119.9, HRR=0.57)
2025-09-13 09:30:59,077 - strava_training_load - INFO - TRIMP_CALC: Average calculation completed, result=73.28
2025-09-13 09:30:59,077 - db_utils - INFO - db_utils: Database connection closed.
