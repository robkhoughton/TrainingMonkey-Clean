<div className={styles.chartContainer}>
        <h2 className={styles.chartTitle}>Overtraining Risk Analysis</h2>
        <div className={styles.chartWrapper} style={{ width: chartDimensions.width, height: chartDimensions.height }}>
          <ResponsiveContainer width="100%" height="100%" key={`divergence-${renderKey}`}>
            <LineChart
              data={filtered}
              margin={{ top: 20, right: 30, left: 100, bottom: 25 }}
            >
              <CartesianGrid strokeDasharray="3 3" />
              <XAxis
                dataKey="date"
                interval={chartDimensions.majorTickInterval}
                tickFormatter={formatXAxis}
                padding={{ left: 10, right: 10 }}
              />
              <YAxis
                domain={getDivergenceDomain(filtered)}
                label={{
                  value: 'Normalized Divergence',
                  angle: -90,
                  position: 'outside',
                  offset: -90,
                  style: { textAnchor: 'middle', fontSize: '14px', fontWeight: '500' }
                }}
                tickFormatter={(value) => value.toFixed(2)}
                width={90}
                reversed={true}
              />
              <Tooltip
                content={<CustomTooltip />}
                cursor={{ strokeDasharray: '3 3' }}
                wrapperStyle={{ pointerEvents: 'auto' }}
              />
              <Legend />

              {/* RESTORED: Background color regions with proper styling */}

              {/* Efficient Zone (positive values - top of inverted chart) */}
              <ReferenceArea
                y1={getDivergenceDomain(filtered)[0]} // Most positive (top)
                y2={0.05}
                fill={`${colors.primary}${defaultTheme.referenceAreas.efficient.fillOpacity}`}
                stroke={colors.primary}
                strokeOpacity={defaultTheme.referenceAreas.efficient.strokeOpacity}
                strokeWidth={defaultTheme.referenceAreas.efficient.strokeWidth}
                label={{
                  value: "Efficient Zone",
                  position: "insideTop",
                  fontSize: defaultTheme.referenceAreas.efficient.fontSize,
                  fill: colors.primary,
                  fontWeight: 'bold'
                }}
              />

              {/* Balanced Zone (-0.05 to +0.05) */}
              <ReferenceArea
                y1={0.05}
                y2={-0.05}
                fill={`${colors.secondary}${defaultTheme.referenceAreas.optimal.fillOpacity}`}
                stroke={colors.secondary}
                strokeOpacity={defaultTheme.referenceAreas.optimal.strokeOpacity}
                strokeWidth={defaultTheme.referenceAreas.optimal.strokeWidth}
                label={{
                  value: "Balanced Zone",
                  position: "insideTop",
                  fontSize: defaultTheme.referenceAreas.optimal.fontSize,
                  fill: colors.secondary,
                  fontWeight: 'bold'
                }}
              />

              {/* Moderate Risk Zone (-0.15 to -0.05) */}
              <ReferenceArea
                y1={-0.05}
                y2={-0.15}
                fill={`${colors.warning}${defaultTheme.referenceAreas.moderate.fillOpacity}`}
                stroke={colors.warning}
                strokeOpacity={defaultTheme.referenceAreas.moderate.strokeOpacity}
                strokeWidth={defaultTheme.referenceAreas.moderate.strokeWidth}
                label={{
                  value: "Moderate Risk",
                  position: "insideBottom",
                  fontSize: defaultTheme.referenceAreas.moderate.fontSize,
                  fill: colors.warning,
                  fontWeight: 'bold'
                }}
              />

              {/* High Risk Zone (negative values - bottom of inverted chart) */}
              <ReferenceArea
                y1={-0.15}
                y2={getDivergenceDomain(filtered)[1]} // Most negative (bottom)
                fill={`${colors.danger}${defaultTheme.referenceAreas.risk.fillOpacity}`}
                stroke={colors.danger}
                strokeOpacity={defaultTheme.referenceAreas.risk.strokeOpacity}
                strokeWidth={defaultTheme.referenceAreas.risk.strokeWidth}
                label={{
                  value: "High Overtraining Risk",
                  position: "insideBottom",
                  fontSize: defaultTheme.referenceAreas.risk.fontSize,
                  fill: colors.danger,
                  fontWeight: 'bold'
                }}
              />

              {/* Zero reference line */}
              <ReferenceLine
                y={0}
                stroke="#374151"
                strokeWidth={2}
                strokeDasharray="4 4"
              />

              <Line
                type="monotone"
                dataKey="normalized_divergence"
                stroke="#8b5cf6"
                strokeWidth={3}
                dot={{ fill: '#8b5cf6', strokeWidth: 2, r: 4 }}
                activeDot={{ r: 7, strokeWidth: 2 }}
                name="Normalized Divergence"
                connectNulls={false}
                isAnimationActive={false}
              />
            </LineChart>
          </ResponsiveContainer>
        </div>